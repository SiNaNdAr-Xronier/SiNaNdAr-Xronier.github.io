<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Xeoner&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Xeoner&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Xeoner&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="some description"><meta property="og:type" content="blog"><meta property="og:title" content="Xeoner&#039;s Blog"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Xeoner&#039;s Blog"><meta property="og:description" content="some description"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="Xeoner"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Xeoner's Blog","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Xeoner"},"publisher":{"@type":"Organization","name":"Xeoner's Blog","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"some description"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600&amp;family=Roboto+Mono"><link data-pjax rel="stylesheet" href="/css/cyberpunk.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-M6KHR911M6" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-M6KHR911M6');</script><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Xeoner&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-01-02T12:56:29.000Z" title="2021. 1. 2. ì˜¤í›„ 9:56:29">2021-01-02</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:58:38.889Z" title="2024. 12. 3. ì˜¤í›„ 2:58:38">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a><span>Â /Â </span><a class="link-muted" href="/categories/Study/Kaggle-Dacon/">Kaggle, Dacon</a></span><span class="level-item">4 minutes read (About 614 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/01/02/Dacon%ED%9B%84%EA%B8%B0_2/">ì¹˜ì—´í•œ-ë°ì´ì½˜í›„ê¸°</a></p><div class="content"><h2 id="ë°ì´ì½˜-ìµœê·¼-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „"><a href="#ë°ì´ì½˜-ìµœê·¼-ëŒ€íšŒ-í›„ê¸°-ë°ì´ì½˜-ì–´ë‚˜ë”-ë²„ì „" class="headerlink" title="ë°ì´ì½˜ ìµœê·¼ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „"></a>ë°ì´ì½˜ ìµœê·¼ ëŒ€íšŒ í›„ê¸° - ë°ì´ì½˜ ì–´ë‚˜ë” ë²„ì „</h2><p>  í¥ë¯¸ë¡­ì§€ë§Œ quantile lossâ€¦ ë³µì¡í•˜ì§€ë§Œ í’€ì´ë²•ì€ ìˆë‹¤.<br>  ê·¸ëƒ¥ quantile ë³„ë¡œ ëŒë¦¬ì§€ ë§ê³  1.0ì— ëŒ€í•œ ê°’ì„ ì˜ˆì¸¡í•œ ë’¤ 0.5 ~ 1.0 ë²”ìœ„ë¡œ í•˜ë©´ ë;;<br>  <del>loss function ìˆ˜ì‹êµ¬í˜„ì€ ì‰½ì§€ë§Œ lossë¥¼ ì¤„ì´ëŠ” ë°©ë²•ì´ ê´€ê±´ì´ë‹¤.</del><br>  <del>ì§„ì§œ 4.1ì—ì„œ ì¤„ì–´ë“¤ì§€ ì•ŠëŠ” lossâ€¦ ê³¼ì—° ì–´ë–»ê²Œ í•˜ë©´ ì¤„ì¼ìˆ˜ ìˆì„ê¹Œâ€¦</del></p>
<h3 id="ë‹¤ë³€ëŸ‰-íšŒê·€-ì™œ-ì´ë ‡ê²Œ-ì–´ë ¤ìš¸ê¹Œìš”-ë°ì´ì½˜-ëŒ€íšŒì—ì„œ-ì–»ì€-ì—„ì²­ë‚œ-êµí›ˆ"><a href="#ë‹¤ë³€ëŸ‰-íšŒê·€-ì™œ-ì´ë ‡ê²Œ-ì–´ë ¤ìš¸ê¹Œìš”-ë°ì´ì½˜-ëŒ€íšŒì—ì„œ-ì–»ì€-ì—„ì²­ë‚œ-êµí›ˆ" class="headerlink" title="ë‹¤ë³€ëŸ‰ íšŒê·€ ì™œ ì´ë ‡ê²Œ ì–´ë ¤ìš¸ê¹Œìš”? - ë°ì´ì½˜ ëŒ€íšŒì—ì„œ ì–»ì€ ì—„ì²­ë‚œ êµí›ˆ"></a>ë‹¤ë³€ëŸ‰ íšŒê·€ ì™œ ì´ë ‡ê²Œ ì–´ë ¤ìš¸ê¹Œìš”? - ë°ì´ì½˜ ëŒ€íšŒì—ì„œ ì–»ì€ ì—„ì²­ë‚œ êµí›ˆ</h3><p>  <del>loss ê³„ì‚°í• ë•Œ ë‹¤ë¥¸ target ê°’ê³¼ x_trainê°’ì´ ì•„ë‹Œ</del></p>
<p>  <del>ë‹¤ë¥¸ Element ë¼ë¦¬ ê³„ì‚°ë˜ì–´ì„œ ì˜¤íˆë ¤ lossê°€ í­ì¦í•˜ê¸°ë„ í•œë‹¤ ì´ë ‡ê²Œ í•˜ë©´ 8:45 ëœë‹¤.</del></p>
<p>  Wandbë¡œ ì‹œê°í™” ì•ˆí–ˆìœ¼ë©´ í°ì¼ë‚¬ì—ˆì„ë“¯ ì‹¶ì—ˆë‹¤. </p>
<p>  Loss ì‹œê°í™” íˆ´ë¡œ ë³´ë‹ˆ ì´ˆë°˜ì—ì„œ ìˆ˜ë ´í•˜ì§€ ì•ŠëŠ” ë¬¸ì œë‚˜ ì•„ì˜ˆ uìë¡œ ë¶ˆê·œì¹™ì ìœ¼ë¡œ íŠ€ëŠ” í˜„ìƒë„ ë°œìƒâ€¦.</p>
<p>  <img src="/img/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/%EC%8B%A0%EA%B8%B0%ED%95%9C%EA%B7%B8%EB%9E%98%ED%94%84.PNG" alt="lossê°€ ì¤„ì–´ë“œëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì‹¤ì œëŠ” ..."></p>
<p>  <del>ë¶„ëª… window datasetìœ¼ë¡œ ë¶€í•˜ë¶„ì‚°ì„ í•˜ë©´ ë°ì´í„° ì²˜ë¦¬ê°€ ìˆ˜ì›”í•  ê²ƒ ê°™ì§€ë§Œâ€¦ì´ë ‡ê²Œ ë˜ë©´ ë—;;;</del></p>
<p>  <del>ì±„ì ì„ í•´ë³´ë‹ˆ ê·¹ì•…ì˜ Lossê°€ ë‚˜ì˜¤ê¸°ë„ í•œë‹¤. ì—ì¸¡ labelê³¼ train testì˜ shapeì„ í™•ì¸ ë˜ í™•ì¸..</del></p>
<p>  ë–„ì—ëŠ” window_size, buffer sizeë¥¼ ì˜ ì¡°ì ˆí•´ì•¼ í•œë‹¤.</p>
<p>  window_sizeë¥¼ ë„ˆë¬´ ë‚®ì¶”ë©´ ìì¹«í•˜ë©´ GPU ì‚¬ìš©ë¥ ì€ í•œìë¦¬ì— ë¨¸ë¬¼ê³  ì‹œê°„ì€ ì˜¤ë˜ ê±¸ë¦°ë‹¤. </p>
<p>  í•˜ì§€ë§Œ GPU RAM ì‚¬ìš©ëŸ‰ì€ ì¤„ì–´ë“œëŠ” ì´ì ì€ ìˆë‹¤.</p>
<p>  window datasetì„ í•˜ë‹¤ë³´ë©´ ë°°ì¹˜ í¬ê¸°ê°€ ì•ˆ ë§ì•„ì„œ ì˜ˆì¸¡ì´ ì•ˆë ë•Œê°€ ìˆëŠ”ë° ì´ëŸ´ë•â€¦<br>  <img src="/img/%EC%B9%98%EC%97%B4%ED%95%9C-%EB%8D%B0%EC%9D%B4%EC%BD%98%ED%9B%84%EA%B8%B0/%ED%9D%90%EC%9D%B5.PNG" alt="ë°°ì¹˜ í¬ê¸°ê°€ ì•ˆë§ì„ ë–„ëŠ” ì´ë ‡ê²Œ paddingì„ ì“´ë‹¤."></p>
<p>  Shuffle Buffer size ì¡°ì ˆì€ í•„ìˆ˜, batch Sizeì— ì£¼ì˜í•˜ì—¬ ì¡°ì ˆí•œë‹¤.<br>  ê·¸ë ‡ì§€ ì•Šìœ¼ë©´(BATCH SIZEê°€ êµ‰ì¥íˆ ë†’ë‹¤ë©´)<br>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WARNING:tensorflow:5 out of the last 5 calls to &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x7f2570221d30&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for  more details. </span><br></pre></td></tr></table></figure></p>
<p>  ì´ëŸ° ê²½ê³ ê°€ ë‚˜ì˜¨ë‹¤.. -&gt; batch sizeë¥¼ ë°˜ë“œì‹œ ì¡°ì ˆí•˜ê±°ë‚˜ batch paddingâ€¦</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-08T15:16:14.000Z" title="2020. 12. 9. ì˜¤ì „ 12:16:14">2020-12-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:48:01.492Z" title="2024. 12. 3. ì˜¤í›„ 2:48:01">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Competition/">Competition</a></span><span class="level-item">2 minutes read (About 252 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/09/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/">ì¸ê³µì§€ëŠ¥ ê²½ì§„ëŒ€íšŒ í›„ê¸°</a></p><div class="content"><h2 id="ì¸ê³µì§€ëŠ¥-ë¬¸ì œí•´ê²°-ê²½ì§„ëŒ€íšŒ-ì°¸ê°€í›„ê¸°-2020-2021-ğŸ””"><a href="#ì¸ê³µì§€ëŠ¥-ë¬¸ì œí•´ê²°-ê²½ì§„ëŒ€íšŒ-ì°¸ê°€í›„ê¸°-2020-2021-ğŸ””" class="headerlink" title="ì¸ê³µì§€ëŠ¥ ë¬¸ì œí•´ê²° ê²½ì§„ëŒ€íšŒ ì°¸ê°€í›„ê¸° 2020, 2021 ğŸ””"></a>ì¸ê³µì§€ëŠ¥ ë¬¸ì œí•´ê²° ê²½ì§„ëŒ€íšŒ ì°¸ê°€í›„ê¸° 2020, 2021 ğŸ””</h2><p>  ì •ë§ ì¹˜ì—´í–ˆë˜ ê²½ì§„ëŒ€íšŒì˜€ë‹¤. </p>
<p>  ì²˜ìŒì—ëŠ” ì´ë¯¸ì§€ ë©€í‹°ë¼ë²¨ ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œê°€ ë‚˜ì™”ì—ˆê³   </p>
<p>  ê·¸ ì´í›„ ë³¸ì„ ëŒ€íšŒì—ì„œëŠ” NLP, OCR, GAN ë“± ì—¬ëŸ¬ ë„ë©”ì¸ ë¬¸ì œê°€ ì¶œí˜„í–ˆì—ˆë‹¤  </p>
<p>  ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ê·¸ëŸ°ê±´ ì‚¬ì‹¤ìƒ ì—†ã…‹ìŒã…‹..ğŸ”</p>
<p>  ê·¸ëƒ¥ ë°ì´í„°ë¥¼ ë§ ê·¸ëŒ€ë¡œ í•´ì²´ ë¶„ì„ì„ í–ˆì–´ì•¼ í–ˆë‹¤.</p>
<p>  ì•„ë¬´ë¦¬ Data Clensingì„ í•´ë„ ê·¸ëŒ€ë¡œì¸ lossì™€ scoreâ€¦ 8:45ğŸ•›</p>
<p>  ê²°êµ­ ì•„ì˜ˆ ë¦¬ëª¨ë¸ë§, ë°ì´í„° Cleanize í•œ ë’¤ì— í•™ìŠµì„ ë‹¤ì‹œ ëŒë ¸ë‹¤.</p>
<p>  ì²œì‹ ë§Œê³  ëì—â€¦</p>
<p>  <img src="/img/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/2222.PNG" alt="ìµœì¢…ìˆœìœ„...ã„·ã„·ã„·"></p>
<p>  <img src="/img/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/3333.PNG" alt="ìµœì¢…ìˆœìœ„ ã…ã„·ã„·"></p>
<p>  <img src="/img/%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B2%BD%EC%A7%84%EB%8C%80%ED%9A%8C-%ED%9B%84%EA%B8%B0/4444.PNG" alt="ìµœì¢…ìˆœìœ„ ã„·ã„·ã„·;;"><br>    ì°¸ê³ ë¡œ íŒ€ëª…ì€ <del>í’ì„ ë„ìš°ê¸°</del> ;;</p>
<p>  ëª…ë‹¨ì— ë°œí‘œë˜ê¸°ê¹Œì§€ ì—„ì²­ë‚œ ê¸´ì¥ê°ì´â€¦ğŸŒ¡ğŸ“ˆ</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-06T12:48:20.000Z" title="2020. 12. 6. ì˜¤í›„ 9:48:20">2020-12-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T06:00:13.838Z" title="2024. 12. 3. ì˜¤í›„ 3:00:13">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a><span>Â /Â </span><a class="link-muted" href="/categories/Study/Kaggle-Dacon/">Kaggle, Dacon</a></span><span class="level-item">2 minutes read (About 313 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/06/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/">Daconë„ì „ê¸°</a></p><div class="content"><h2 id="ë°ì´ì½˜-ë„ì „-í›„ê¸°"><a href="#ë°ì´ì½˜-ë„ì „-í›„ê¸°" class="headerlink" title="ë°ì´ì½˜ ë„ì „ í›„ê¸°"></a>ë°ì´ì½˜ ë„ì „ í›„ê¸°</h2><p>  í¥ë¯¸ë¡­ì§€ë§Œ ì‰½ì§€ëŠ” ì•Šë‹¤.<br>  ë§ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ íŒŒìƒë³€ìˆ˜, ëª¨ë¸ì„ ë§ì´ ë§Œë“¤ë©´ ì ìˆ˜ê°€ ì˜¤ë¥´ê¸´ í•œë‹¤.</p>
<p>  <a target="_blank" rel="noopener" href="https://dacon.io/competitions/open/235597/leaderboard/">ë°ì´ì½˜_ì—°ìŠµë¬¸ì œ</a></p>
<p>  ì—°ìŠµìš©ì´ê¸´ í•œë° BERTëª¨ë¸ í­ê²©ìœ¼ë¡œ <del>ì–‘ë¯¼í•™ì‚´</del> ì´ ë²Œì¨ë¶€í„° ì‹œì‘ë˜ì—ˆâ€¦ã…ã„·ã„·</p>
<p>  ë²„íŠ¸ëª¨ë¸ ì•ˆì“°ê³ ë„ ìˆœìœ„ ì˜¬ë¦´ìˆ˜ëŠ” ìˆë‹¤. </p>
<p>  ì§€ê¸ˆë¶€í„° ê·¸ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p>
<h3 id="ë°ì´ì½˜-ìˆœìœ„ë¥¼-ì˜¬ë¦´ìˆ˜-ìˆëŠ”-ë°©ë²•-ì°½ì˜ì ì¸-modeling-K-cross-Validation-parameter-searching"><a href="#ë°ì´ì½˜-ìˆœìœ„ë¥¼-ì˜¬ë¦´ìˆ˜-ìˆëŠ”-ë°©ë²•-ì°½ì˜ì ì¸-modeling-K-cross-Validation-parameter-searching" class="headerlink" title="ë°ì´ì½˜ ìˆœìœ„ë¥¼ ì˜¬ë¦´ìˆ˜ ìˆëŠ” ë°©ë²• - ì°½ì˜ì ì¸ modeling, K-cross Validation, parameter searching"></a>ë°ì´ì½˜ ìˆœìœ„ë¥¼ ì˜¬ë¦´ìˆ˜ ìˆëŠ” ë°©ë²• - ì°½ì˜ì ì¸ modeling, K-cross Validation, parameter searching</h3><p>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_1.PNG" alt="ì´ê²ƒì´ ë°”ë¡œ VDCNN">  </p>
<p>  VDCNNì€ GPUê°€ ì˜ ë²„í…¨ì£¼ë©´<br>  0.86ê¹Œì§€ëŠ” ë§ˆêµ¬ë§ˆêµ¬ ì˜¬ë¦´ìˆ˜ ìˆìŒ.  </p>
<p>  ì´ê²ƒì´ ë°”ë¡œ VDCNNì´ë‹¹!<br>  <a target="_blank" rel="noopener" href="https://github.com/melody-sigma/VDCNN_kor"><img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_5.PNG" alt="VDCNN code"></a></p>
<p>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/vdcnn_9.PNG" alt="VDCNN í•™ìŠµì¥ë©´"></p>
<p>  í•™ìŠµ ëª¨ë¸ì„ ê·¸ë¦¼ìœ¼ë¡œ ë³´ê¸°</p>
<p>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_36_0.png" alt="VDCNN ê·¸ë¦¼1"></p>
<p>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/Dacon01.PNG" alt="ë°ì´ì½˜ ê²°ê³¼"><br>  ì—¬ê¸°ì— ì—¬ëŸ¬ ê°€ì§€ ëª¨ë¸ Ensemble í•´ë³´ë©´ 0.88ì€ ê°€ëŠ¥í•´ë³´ì¼ ê²ƒ ê°™ë„¤ìš”.</p>
<blockquote>
<p>ì¶”ê°€ë¡œ ëª¨ë¸ Ensemble ì„ ì‹œë„<br>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_43_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸1"><br>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_50_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸2"><br>  <img src="/img/Dacon%EB%8F%84%EC%A0%84%EA%B8%B0/output_57_0.png" alt="ì¶”ê°€í–ˆë˜ ëª¨ë¸3"></p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-03T09:41:05.000Z" title="2020. 12. 3. ì˜¤í›„ 6:41:05">2020-12-03</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:50:03.474Z" title="2024. 12. 3. ì˜¤í›„ 2:50:03">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">31 minutes read (About 4663 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/">ë”¥ëŸ¬ë‹-ì…ë¬¸í•˜ê¸°-9</a></p><div class="content"><h2 id="ì§€ë‚œë²ˆì—-ì´ì–´ì„œ-ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-2ë²ˆì§¸"><a href="#ì§€ë‚œë²ˆì—-ì´ì–´ì„œ-ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-2ë²ˆì§¸" class="headerlink" title="ì§€ë‚œë²ˆì— ì´ì–´ì„œ ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ 2ë²ˆì§¸"></a>ì§€ë‚œë²ˆì— ì´ì–´ì„œ ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ 2ë²ˆì§¸</h2><h2 id="2-Sound-Representation"><a href="#2-Sound-Representation" class="headerlink" title="2. Sound Representation"></a>2. Sound Representation</h2><p>ìœ„ì—ì„œ Samplingëœ discreteí•œ ë°ì´í„°ë¥¼ ì´ì œ ìš°ë¦¬ëŠ” í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ ìš”ì†Œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì €í¬ê°€ ë°ì´í„°ë¥¼ í‘œí˜„í•´ì•¼í• ê¹Œìš”?, ì²«ë²ˆì§¸ëŠ” ì‹œê°„ì˜ íë¦„ì— ë”°ë¼, ê³µê¸°ì˜ íŒŒë™ì˜ í¬ê¸°ë¡œ ë³´ëŠ” Time-domain Representation ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤. ë‘ë²ˆì§¸ëŠ” ì‹œê°„ì— ë”°ë¼ì„œ frequencyì˜ ë³€í™”ë¥¼ ë³´ëŠ” Time-Frequency representationì´ ìˆìŠµë‹ˆë‹¤. </p>
<h3 id="2-1-Time-domain-Waveform"><a href="#2-1-Time-domain-Waveform" class="headerlink" title="2.1. Time domain - Waveform"></a>2.1. Time domain - Waveform</h3><p>Waveformì˜ ê²½ìš°ì—ëŠ” ì˜¤ë””ì˜¤ì˜ ìì—°ì ì´ í‘œí˜„ì…ë‹ˆë‹¤. ì‹œê°„ì´ xì¶•ìœ¼ë¡œ ê·¸ë¦¬ê³  amplitudeê°€ yì¶•ìœ¼ë¡œ í‘œí˜„ì´ ë©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize = (<span class="number">14</span>,<span class="number">5</span>))</span><br><span class="line">librosa.display.waveplot(y[<span class="number">0</span>:<span class="number">10000</span>], sr=sr)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.collections.PolyCollection at 0x7fa325708d50&gt;
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_21_1.png" alt="png"></p>
<h3 id="ì •í˜„íŒŒ-Sinusoid"><a href="#ì •í˜„íŒŒ-Sinusoid" class="headerlink" title="ì •í˜„íŒŒ (Sinusoid)"></a>ì •í˜„íŒŒ (Sinusoid)</h3><p>ëª¨ë“  ì‹ í˜¸ëŠ” ì£¼íŒŒìˆ˜(frequency)ì™€ í¬ê¸°(magnitude), ìœ„ìƒ(phase)ì´ ë‹¤ë¥¸ ì •í˜„íŒŒ(sinusolida signal)ì˜ ì¡°í•©ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. í“¨ë¦¬ì— ë³€í™˜ì€ ì¡°í•©ëœ ì •í˜„íŒŒì˜ í•©(í•˜ëª¨ë‹ˆ) ì‹ í˜¸ì—ì„œ ê·¸ ì‹ í˜¸ë¥¼ êµ¬ì„±í•˜ëŠ” ì •í˜„íŒŒë“¤ì„ ê°ê° ë¶„ë¦¬í•´ë‚´ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sr = <span class="number">16000</span> <span class="comment"># sample rate</span></span><br><span class="line">T = <span class="number">2.0</span>    <span class="comment"># seconds</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, T, <span class="built_in">int</span>(T*sr), endpoint=<span class="literal">False</span>) <span class="comment"># time variable</span></span><br><span class="line">x = <span class="number">0.5</span>*np.sin(<span class="number">2</span>*np.pi*<span class="number">440</span>*t)                <span class="comment"># pure sine wave at 440 Hz</span></span><br><span class="line"><span class="comment"># y = 0.5*numpy.sin(2*numpy.pi*400*t)</span></span><br><span class="line"></span><br><span class="line">ipd.Audio(x, rate=sr) <span class="comment"># load a NumPy array</span></span><br></pre></td></tr></table></figure>








<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">librosa.display.waveplot(x[:<span class="number">50</span>], sr=sr)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.collections.PolyCollection at 0x7fa327a01550&gt;
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_24_1.png" alt="png"></p>
<h3 id="í‘¸ë¦¬ì—-ë³€í™˜-Fourier-transform"><a href="#í‘¸ë¦¬ì—-ë³€í™˜-Fourier-transform" class="headerlink" title="í‘¸ë¦¬ì— ë³€í™˜ (Fourier transform)"></a>í‘¸ë¦¬ì— ë³€í™˜ (Fourier transform)</h3><p>í‘¸ë¦¬ì— ë³€í™˜(Fourier transform)ì„ ì§ê´€ì ìœ¼ë¡œ ì„¤ëª…í•˜ë©´ í‘¸ë¦¬ì— ë³€í™˜ì€ ì„ì˜ì˜ ì…ë ¥ ì‹ í˜¸ë¥¼ ë‹¤ì–‘í•œ ì£¼íŒŒìˆ˜ë¥¼ ê°–ëŠ” ì£¼ê¸°í•¨ìˆ˜(ë³µìˆ˜ ì§€ìˆ˜í•¨ìˆ˜)ë“¤ì˜ í•©ìœ¼ë¡œ ë¶„í•´í•˜ì—¬ í‘œí˜„í•˜ëŠ” ê²ƒ ì…ë‹ˆë‹¤. ê·¸ë¦¬ê³  ê° ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ ì§„í­ì„ êµ¬í•˜ëŠ” ê³¼ì •ì„ í“¨ë¦¬ì— ë³€í™˜ì´ë¼ê³  í•©ë‹ˆë‹¤.</p>
<ul>
<li>ì£¼ê¸°(period): íŒŒë™ì´ í•œë²ˆ ì§„ë™í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„, ë˜ëŠ” ê·¸ ê¸¸ì´, ì¼ë°˜ì ìœ¼ë¡œ siní•¨ìˆ˜ì˜ ì£¼ê¸°ëŠ” \(2\pi &#x2F;w\)ì…ë‹ˆë‹¤</li>
<li>ì£¼íŒŒìˆ˜(frequency): 1ì´ˆë™ì•ˆì˜ ì§„ë™íšŸìˆ˜ì…ë‹ˆë‹¤.</li>
</ul>
<p>í“¨ë¦¬ì— ë³€í™˜ì˜ ì‹ì„ ì‚´í´ë´…ì‹œë‹¤.</p>
<p>$$y(t)&#x3D;\sum_{k&#x3D;-\infty}^\infty A_k , \exp \left( i\cdot 2\pi\frac{k}{T} t \right)$$</p>
<p>ì´ ì‹ì„ í•˜ë‚˜ì‹ í•´ì„í•´ë´…ì‹œë‹¤.<br>\(k\)ëŠ” \(-\infty\) ~ \(\infty\)ì˜ ë²”ìœ„ë¥¼ ê°€ì§€ê³  ì›€ì§ì…ë‹ˆë‹¤.<br>ì´ê²ƒì€ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ ê°¯ìˆ˜ì…ë‹ˆë‹¤. ì–´ë– í•œ ì‹ í˜¸ê°€ ë‹¤ë¥¸ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ í•©ìœ¼ë¡œ í‘œí˜„ë˜ëŠ”ë°, ê·¸ ì£¼ê¸°í•¨ìˆ˜ëŠ” ë¬´í•œëŒ€ì˜ ë²”ìœ„ì— ìˆêµ°ìš”.</p>
<p>ê·¸ë ‡ë‹¤ë©´ \(A_k\)ì€ ê·¸ ì‚¬ì¸í•¨ìˆ˜ì˜ ì§„í­ì´ë¼ê³  í•©ë‹ˆë‹¤. ì´ ì‹ì€ ì‹œê°„ì— ëŒ€í•œ ì…ë ¥ì‹ í˜¸ \(y_{t}\)ê°€  \(\exp \left( i\cdot 2\pi\frac{k}{T} t \right)\) ì™€ ì§„í­(\(A_k\))ì˜ ì„ í˜•ê²°í•©ìœ¼ë¡œ í‘œí˜„ë¨ì„ ë§í•˜ê³  ìˆêµ°ìš”.</p>
<p>ìœ„ ê·¸ë¦¼ì„ ë³¸ë‹¤ë©´ ì¡°ê¸ˆ ë” ëª…í™•íˆ ì•Œìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ë¶‰ì€ìƒ‰ ë¼ì¸ì´ ì…ë ¥ì‹ í˜¸ \(y_{t}\) ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ ë‹¤ë£¨ê²Œ ë˜ëŠ” ë°ì´í„°ì¸ ìŒì•…ì´ë‚˜ ëª©ì†Œë¦¬ ê°™ì€ ë°ì´í„° ì—­ì‹œ complex toneì…ë‹ˆë‹¤. ì—¬ë ¤ê°œì˜ ì£¼íŒŒìˆ˜ì˜ì—­ì´ í•©ì³ì§„ ê²ƒì´ì£ . ì´ëŸ¬í•œ ì—¬ëŸ¬ê°œì˜ ì£¼íŒŒìˆ˜ ì˜ì—­ì„ ë¶„ë¦¬í•˜ì!ê°€ ì£¼ìš”í•œ ì•„ì´ë””ì–´ì…ë‹ˆë‹¤. íŒŒë€ìƒ‰ ì£¼ê¸°í•¨ìˆ˜ë“¤ì„ ë³´ì‹ ë‹¤ë©´ ì—¬ëŸ¬ê°œì˜ ì£¼ê¸°í•¨ìˆ˜ë“¤ì„ ì°¾ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ ì£¼ê¸°í•¨ìˆ˜ë“¤ì€ ê³ ìœ ì˜ ì£¼íŒŒìˆ˜(frequency)ì™€ ê°•ë„(amplitude)ë¥¼ ê°€ì§€ê³  ìˆê³  ê·¸ê²ƒì´ íŒŒë€ìƒ‰ì˜ ë¼ì¸ë“¤ë¡œ í‘œí˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>
<p>ì§„í­ì— ëŒ€í•œ ìˆ˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.<br>$$A_k &#x3D; \frac{1}{T} \int_{-\frac{T}{2}}^\frac{T}{2} f(t) , \exp \left( -i\cdot 2\pi \frac{k}{T} t \right) , dt$$<br>ì—¬ê¸°ì„œ í•˜ë‚˜ì˜ ì˜ë¬¸ì ì´ ë“œì‹¤ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì£¼ê¸°í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„ëœë‹¤ê³  í–ˆëŠ”ë° ì €í¬ê°€ ë³´ê³  ìˆëŠ”ê²ƒì€ \(\exp \left( i\cdot 2\pi\frac{k}{T} t \right)\) ì§€ìˆ˜í•¨ìˆ˜ì˜ í˜•íƒœì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</p>
<p>ì§€ìˆ˜í•¨ìˆ˜ì™€ ì£¼ê¸°í•¨ìˆ˜ ì‚¬ì´ì˜ ì—°ê´€ê´€ê³„ëŠ” ë¬´ì—‡ì¼ê¹Œìš”? ê·¸ ê´€ê³„ë¥¼ ì°¾ì€ ê²ƒì´ ë°”ë¡œ ì˜¤ì¼ëŸ¬ ê³µì‹ì…ë‹ˆë‹¤.</p>
<p>$$e^{i\theta} &#x3D; \cos{\theta} + i\sin{\theta}$$</p>
<p>ì´ ì‹ì„ ìœ„ ì‹ì²˜ëŸ¼ í‘œí˜„í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤<br>$$\exp \left( i\cdot 2\pi\frac{k}{T} t \right) &#x3D; \cos\left({2\pi\frac{k}{T}}\right) + i\sin\left({2\pi\frac{k}{T}}\right)$$</p>
<p>ì—¬ê¸°ì„œ \(\cos{2\pi\frac{k}{T}}\), \(i\sin{2\pi\frac{k}{T}}\) í•¨ìˆ˜ëŠ” ì£¼ê¸°ì™€ ì£¼íŒŒìˆ˜ë¥¼ ê°€ì§€ëŠ” ì£¼ê¸°í•¨ìˆ˜ì…ë‹ˆë‹¤. </p>
<p>ì¦‰ í“¨ë¦¬ì— ë³€í™˜ì€ ì…ë ¥ singalì´ ì–´ë–¤ê²ƒì¸ì§€ ìƒê´€ì—†ì´ sin, cosê³¼ ê°™ì€ ì£¼ê¸°í•¨ìˆ˜ë“¤ì˜ í•©ìœ¼ë¡œ í•­ìƒ ë¶„í•´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. </p>
<h3 id="Fourier-Transformì˜-Orthogonal"><a href="#Fourier-Transformì˜-Orthogonal" class="headerlink" title="Fourier Transformì˜ Orthogonal"></a>Fourier Transformì˜ Orthogonal</h3><p>$$y(t)&#x3D;\sum_{k&#x3D;-\infty}^\infty A_k , \exp \left( i\cdot 2\pi\frac{k}{T} t \right)$$</p>
<p>ì–´ë– í•œ ì£¼ê¸°í•¨ìˆ˜ë¥¼ ìš°ë¦¬ëŠ” cosê³¼ siní•¨ìˆ˜ë¡œ í‘œí˜„í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ í•œê°€ì§€ ì¬ë°ŒëŠ” ì ì€, ì´ í•¨ìˆ˜ë“¤ì´ ì§êµí•˜ëŠ” í•¨ìˆ˜(orthogonal)ë¼ëŠ” ì ì´ë‹¤.<br>$${ \exp \left(i\cdot 2\pi\frac{k}{T} t\right) } &#x3D; orthogonal$$</p>
<p>ë²¡í„°ì˜ ì§êµëŠ” í•´ë‹¹ ë²¡í„°ë¥¼ í†µí•´ í‰ë©´ì˜ ëª¨ë“  ì¢Œí‘œë¥¼ í‘œí˜„í• ìˆ˜ ìˆì—ˆë‹¤. í•¨ìˆ˜ì˜ ë‚´ì ì€ ì ë¶„ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ”ë°, ë§Œì•½ êµ¬ê°„ [a,b]ì—ì„œ ì§êµí•˜ëŠ” í•¨ìˆ˜ëŠ” êµ¬ê°„ [a,b]ì˜ ëª¨ë“  í•¨ìˆ˜ë¥¼ í‘œí˜„í• ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p>ìœ„ ì¼€ì´ìŠ¤ì—ì„œëŠ” cos, sin í•¨ìˆ˜ê°€ ì‚¬ì‹¤ìƒ ìš°ë¦¬ ì…ë ¥ì‹ í˜¸ì— ëŒ€í•´ì„œ ê¸°ì €ê°€ ë˜ì–´ì£¼ëŠ” í•¨ìˆ˜ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="DFT-Discrete-Fourier-Transform"><a href="#DFT-Discrete-Fourier-Transform" class="headerlink" title="DFT (Discrete Fourier Transform)"></a>DFT (Discrete Fourier Transform)</h3><p>í•œê°€ì§€ ì˜ë¬¸ì ì´ ë“­ë‹ˆë‹¤. ë°”ë¡œ, ìš°ë¦¬ê°€ samplingìœ¼ë¡œ ë“¤ì–´ì˜¨ ë°ì´í„°ëŠ” ë°”ë¡œ ì‹œê°„ì˜ ê°„ê²©ì— ë”°ë¥¸ ì†Œë¦¬ì˜ amplitudeì˜ discreteí•œ ë°ì´í„°ì´ê¸° ë•Œë¬¸ì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ ìœ„ í‘¸ë¦¬ì— ë³€í™˜ ì‹ì„ Discreteí•œ ì˜ì—­ìœ¼ë¡œ ìƒê°í•´ë´…ì‹œë‹¤.</p>
<p>ë§Œì•½ì— ìš°ë¦¬ê°€ ìˆ˜ì§‘í•œ ë°ì´í„° \(y_{n}\)ì—ì„œ, ì´ì‚° ì‹œê³„ì—´ ë°ì´í„°ê°€ ì£¼ê¸° \(N\)ìœ¼ë¡œ ë°˜ë³µí•œë‹¤ê³  í• ë•Œ, DFTëŠ” ì£¼íŒŒìˆ˜ì™€ ì§„í­ì´ ë‹¤ë¥¸ \(N\)ê°œì˜ ì‚¬ì¸ í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.<br>$$y_n &#x3D; \frac{1}{N} \sum_{k&#x3D;0}^{N-1} Y_k \cdot \exp \left( i\cdot 2\pi\frac{k}{N} n \right)$$</p>
<p>ìœ„ ì‹ì„ ë³´ë©´ kì˜ rangeê°€ 0ë¶€í„° \(N-1\)ë¡œ ë³€í™”í–ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ë•Œ Spectrum \(Y_{k}\)ë¥¼ ì›ë˜ì˜ ì‹œê³„ì—´ ë°ì´í„°ì— ëŒ€í•œ í“¨ë¦¬ì— ë³€í™˜ê°’ì´ë¼ê³  í•˜ì£ .</p>
<p>$$Y_k &#x3D; \sum_{n&#x3D;0}^{N-1} y_n\cdot \exp \left( -i\cdot 2\pi\frac{k}{N} n \right)$$</p>
<ul>
<li>\(y_{n}\) : input signal</li>
<li>\(n\) : Discrete time index</li>
<li>\(k\) : discrete frequency index</li>
<li>\(Y_{k}\) : kë²ˆì§¸ frequenyì— ëŒ€í•œ Spectrumì˜ ê°’</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">DFT</span>(<span class="params">x</span>):</span><br><span class="line">    N = <span class="built_in">len</span>(x)</span><br><span class="line">    X = np.array([])</span><br><span class="line">    nv = np.arange(N)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        s = np.exp(<span class="number">1j</span>*<span class="number">2</span>*np.pi*k/N*nv)</span><br><span class="line">        X = np.append(X, <span class="built_in">sum</span>(x*np.conjugate(s)))</span><br><span class="line">    <span class="keyword">return</span> X</span><br></pre></td></tr></table></figure>

<h3 id="STFT-Short-Time-Fourier-Transform"><a href="#STFT-Short-Time-Fourier-Transform" class="headerlink" title="STFT (Short-Time Fourier Transform)"></a>STFT (Short-Time Fourier Transform)</h3><p>FFTëŠ” ì‹œê°„ì— íë¦„ì— ë”°ë¼ ì‹ í˜¸ì˜ ìˆ˜íŒŒìˆ˜ê°€ ë³€í–ˆì„ë•Œ, ì–´ëŠ ì‹œê°„ëŒ€ì— ì£¼íŒŒìˆ˜ê°€ ë³€í•˜ëŠ”ì§€ ëª¨ë¥´ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ì„œ, STFTëŠ” ì‹œê°„ì˜ ê¸¸ì´ë¥¼ ë‚˜ëˆ ì„œ ì´ì œ í“¨ë¦¬ì— ë³€í™˜ì„ í•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ FFTë¥¼ í–ˆì„ë•ŒëŠ” Time dominaì— ëŒ€í•œ ì •ë³´ê°€ ë‚ ì•„ê°€ê²Œ ë˜ëŠ” ê²ƒì´ì£ .</p>
<p>ì£¼íŒŒìˆ˜ì˜ íŠ¹ì„±ì´ ì‹œê°„ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” ì‚¬ìš´ë“œë¥¼ ë¶„ì„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ê°€ ì‚¬ìš©í•˜ëŠ” signal ë°ì´í„°ì— ì í•©í•˜ë‹¤. ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì¼ì •í•œ ì‹œê°„ êµ¬ê°„ (window size)ë¡œ ë‚˜ëˆ„ê³ , ê° êµ¬ê°„ì— ëŒ€í•´ì„œ ìŠ¤í™íŠ¸ëŸ¼ì„ êµ¬í•˜ëŠ” ë°ì´í„°ì´ë‹¤. ì´ëŠ” Time-frequency 2ì°¨ì› ë°ì´í„°ë¡œ í‘œí˜„ì´ ë©ë‹ˆë‹¤.</p>
<p>$$X(l,k) &#x3D; \sum_{n&#x3D;0}^{N-1} w(n) x(n+lH)\exp^{\frac{-2\pi k n}{N}}$$</p>
<ul>
<li><p>\(N\) : FFT size</p>
<ul>
<li>Windowë¥¼ ì–¼ë§ˆë‚˜ ë§ì€ ì£¼íŒŒìˆ˜ ë°´ë“œë¡œ ë‚˜ëˆ„ëŠ”ê°€ ì…ë‹ˆë‹¤.</li>
</ul>
</li>
<li><p>Duration</p>
<ul>
<li>ìƒ˜í”Œë§ ë ˆì´íŠ¸ë¥¼ windowë¡œ ë‚˜ëˆˆ ê°’ì…ë‹ˆë‹¤.</li>
<li>$$T&#x3D; window&#x2F;SR$$</li>
<li>T(Window) &#x3D; 5T(Signal), durationì€ ì‹ í˜¸ì£¼ê¸°ë³´ë‹¤ 5ë°° ì´ìƒ ê¸¸ê²Œ ì¡ì•„ì•¼í•œë‹¤.</li>
<li>440Hz ì‹ í˜¸ì˜ window sizeëŠ” 5*(1&#x2F;440)ì´ ë©ë‹ˆë‹¤.</li>
</ul>
</li>
<li><p>\(w(n)\) : Window function</p>
<ul>
<li>ì¼ë°˜ì ìœ¼ë¡œ Hann windowê°€ ì“°ì…ë‹ˆë‹¤.</li>
</ul>
</li>
<li><p>\(n\) : Window size</p>
<ul>
<li>Window í•¨ìˆ˜ì— ë“¤ì–´ê°€ëŠ” Sampleì˜ ì–‘ì…ë‹ˆë‹¤.</li>
<li>ì‘ì„ìˆ˜ë¡ Low-frequency resolutionì„ ê°€ì§€ê²Œ ë˜ê³ , high-time resolutionì„ ê°€ì§‘ë‹ˆë‹¤.</li>
<li>ê¸¸ìˆ˜ë¡ High-frequency, low time resolutionì„ ê°€ì§‘ë‹ˆë‹¤.</li>
</ul>
</li>
<li><p>\(H\) : Hop size</p>
<ul>
<li>ìœˆë„ìš°ê°€ ê²¹ì¹˜ëŠ” ì‚¬ì´ì¦ˆì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” 1&#x2F;4ì •ë„ë¥¼ ê²¹ì¹˜ê²Œ í•©ë‹ˆë‹¤.</li>
</ul>
</li>
</ul>
<p>STFTì˜ ê²°ê³¼ëŠ” ì¦‰ ì‹œê°„ì˜ íë¦„(Window)ì— ë”°ë¥¸ Frequencyì˜ì—­ë³„ Amplitudeë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sr = <span class="number">16000</span> <span class="comment"># sample rate</span></span><br><span class="line">T = <span class="number">2.0</span>    <span class="comment"># seconds</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, T, <span class="built_in">int</span>(T * sr), endpoint=<span class="literal">False</span>) <span class="comment"># time variable</span></span><br><span class="line">x = <span class="number">0.5</span> * np.sin(<span class="number">2</span> * np.pi * <span class="number">440</span> * t)                <span class="comment"># pure sine wave at 440 Hz</span></span><br><span class="line"><span class="comment"># y = 0.5*numpy.sin(2*numpy.pi*400*t)</span></span><br><span class="line"></span><br><span class="line">ipd.Audio(x, rate=sr) <span class="comment"># load a NumPy array</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(y))</span><br><span class="line">D = librosa.stft(y)</span><br><span class="line"><span class="built_in">print</span>(D.shape, D)</span><br><span class="line"></span><br><span class="line"><span class="comment"># phase ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚ ë¦°ë‹¤.</span></span><br><span class="line">D_mag = np.<span class="built_in">abs</span>(D)</span><br><span class="line"><span class="built_in">print</span>(D_mag)</span><br><span class="line"><span class="built_in">print</span>(D_mag.shape)</span><br><span class="line"></span><br><span class="line">magnitude, phase = librosa.magphase(D)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(magnitude)</span><br><span class="line"><span class="built_in">print</span>(magnitude.shape)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(magnitude-D_mag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>48944
(1025, 96) [[-2.1494275e-01+0.0000000e+00j -2.0992082e-01+0.0000000e+00j
  -2.0418610e-01+0.0000000e+00j ... -1.9438802e-01+0.0000000e+00j
  -1.9518623e-01+0.0000000e+00j -2.3163199e-01+0.0000000e+00j]
 [ 9.3493842e-02+6.7762636e-21j  1.2481287e-01+4.8880498e-03j
   7.3961377e-02+1.3274251e-03j ...  7.7925511e-02-1.7781712e-02j
   9.6285135e-02+1.7115690e-02j  1.1564651e-01-5.2810002e-02j]
 [ 1.9829417e-02+8.2818238e-19j -3.1706840e-02+1.5587136e-02j
   5.7078212e-02-2.0519590e-02j ...  2.3265863e-02+7.6752454e-02j
   3.0044108e-03-6.0352467e-02j  5.4616658e-03+6.8522707e-02j]
 ...
 [-5.3125373e-03-1.2618632e-18j  3.4157380e-03-1.7295172e-03j
  -1.8859134e-03-3.5993013e-04j ... -7.6227036e-04-9.3025468e-05j
  -1.8814437e-04-8.4138475e-05j  4.7763987e-04-5.3400453e-04j]
 [ 2.1248308e-03+1.5585406e-19j -1.4035926e-03+8.0862024e-05j
   2.4144542e-03+3.4830419e-04j ... -2.3595782e-04+1.1687888e-03j
   1.1331354e-04+1.2911476e-04j  2.8909228e-04+3.3650018e-04j]
 [-8.1756472e-04+0.0000000e+00j -9.3529455e-04+0.0000000e+00j
  -1.4104146e-03+0.0000000e+00j ...  1.3452002e-03+0.0000000e+00j
  -9.2299597e-06+0.0000000e+00j -4.9439305e-04+0.0000000e+00j]]
[[2.1494275e-01 2.0992082e-01 2.0418610e-01 ... 1.9438802e-01
  1.9518623e-01 2.3163199e-01]
 [9.3493842e-02 1.2490856e-01 7.3973291e-02 ... 7.9928555e-02
  9.7794548e-02 1.2713383e-01]
 [1.9829417e-02 3.5331041e-02 6.0654562e-02 ... 8.0201246e-02
  6.0427204e-02 6.8740025e-02]
 ...
 [5.3125373e-03 3.8286415e-03 1.9199529e-03 ... 7.6792570e-04
  2.0610093e-04 7.1645004e-04]
 [2.1248308e-03 1.4059199e-03 2.4394479e-03 ... 1.1923688e-03
  1.7178644e-04 4.4362905e-04]
 [8.1756472e-04 9.3529455e-04 1.4104146e-03 ... 1.3452002e-03
  9.2299597e-06 4.9439305e-04]]
(1025, 96)
[[2.1494275e-01 2.0992082e-01 2.0418610e-01 ... 1.9438802e-01
  1.9518623e-01 2.3163199e-01]
 [9.3493842e-02 1.2490856e-01 7.3973291e-02 ... 7.9928555e-02
  9.7794548e-02 1.2713383e-01]
 [1.9829417e-02 3.5331041e-02 6.0654562e-02 ... 8.0201246e-02
  6.0427204e-02 6.8740025e-02]
 ...
 [5.3125373e-03 3.8286415e-03 1.9199529e-03 ... 7.6792570e-04
  2.0610093e-04 7.1645004e-04]
 [2.1248308e-03 1.4059199e-03 2.4394479e-03 ... 1.1923688e-03
  1.7178644e-04 4.4362905e-04]
 [8.1756472e-04 9.3529455e-04 1.4104146e-03 ... 1.3452002e-03
  9.2299597e-06 4.9439305e-04]]
(1025, 96)
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">S = librosa.core.stft(audio_np, n_fft=<span class="number">1024</span>, hop_length=<span class="number">512</span>, win_length=<span class="number">1024</span>)</span><br><span class="line">D = np.<span class="built_in">abs</span>(S)**<span class="number">2</span></span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>) <span class="comment">#ì†Œë¦¬ì˜ ë‹¨ìœ„ë¥¼ dbë¡œ ë°”ê¿ˆ </span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=<span class="number">16000</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Window-function"><a href="#Window-function" class="headerlink" title="Window function?"></a>Window function?</h3><p>ìœ„ì—ì„œ Window functionê³¼ Window sizeë¼ëŠ” ì´ì•¼ê¸°ê°€ ë‚˜ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. ìœˆë„ìš° Functionê³¼ SizeëŠ” ì™œ ì“°ëŠ” ê²ƒì´ë©° ì–´ë–¨ë•Œ ì“°ëŠ” ê²ƒì¼ê¹Œìš”?</p>
<p>Window functionì˜ ì£¼ëœ ê¸°ëŠ¥ì€ main-lobeì˜ widthì™€ side-lobeì˜ ë ˆë²¨ì˜ Trade-off ë¥¼ ì œì–´í•´ ì¤€ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê¹ìŠ¤ í˜„ìƒì„ ë§‰ì•„ì£¼ëŠ” ê³ ë§ˆìš´ ì¹œêµ¬ì´ê¸°ë„ í•˜ì£ . ì§€ê¸ˆë‚˜ì˜¨ main-lobe, side-bloe, ê¹ìŠ¤í˜„ìƒì€ ë¬´ì—‡ì¼ê¹Œìš”?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">frame_audio</span>(<span class="params">audio, FFT_size=<span class="number">1024</span>, hop_size=<span class="number">20</span>, sample_rate = <span class="number">22050</span></span>):</span><br><span class="line">    audio = np.pad(audio, <span class="built_in">int</span>(FFT_size/<span class="number">2</span>), mode=<span class="string">&#x27;reflect&#x27;</span>)</span><br><span class="line">    frame_len = np.<span class="built_in">round</span>(sample_rate*hop_size / <span class="number">1000</span>).astype(<span class="built_in">int</span>)</span><br><span class="line">    frame_num = <span class="built_in">int</span>((<span class="built_in">len</span>(audio) - FFT_size) / frame_len) + <span class="number">1</span></span><br><span class="line">    frames = np.zeros((frame_num, FFT_size))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(frame_num):</span><br><span class="line">        frames[n] = audio[n*frame_len:n*frame_len+FFT_size]</span><br><span class="line">    <span class="keyword">return</span> frames</span><br><span class="line"></span><br><span class="line">audio_framed = frame_audio(audio_np)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Framed audio shape: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(audio_framed.shape))</span><br></pre></td></tr></table></figure>

<pre><code>Framed audio shape: (469, 1024)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">window = signal.get_window(<span class="string">&quot;hann&quot;</span>, <span class="number">1024</span>, fftbins=<span class="literal">True</span>)</span><br><span class="line">audio_win = audio_framed * window</span><br><span class="line">ind = <span class="number">2</span></span><br><span class="line">plt.figure(figsize=(<span class="number">15</span>,<span class="number">6</span>))</span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">plt.plot(window)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">plt.plot(audio_framed[ind])</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">plt.plot(audio_win[ind])</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_49_0.png" alt="png"></p>
<p>í”Œë¡¯ì„ ë³´ê²Œ ëœë‹¤ë©´ windowingì„ ì ìš©í•˜ê¸°ì „ plotì€ ëë¶€ë¶„ì´ ë‹¤ ë‹¤ë¥´ì§€ë§Œ, windowingì„ ì§€ë‚˜ê³  ë‚˜ì„œ ë‚˜ì˜¤ëŠ” plotì€ ëì´ 0 ìœ¼ë¡œ ì¼ì¹˜í•œë‹¤ëŠ” íŠ¹ì„±ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="Window-size"><a href="#Window-size" class="headerlink" title="Window size?"></a>Window size?</h3><p>ìœˆë„ìš° ì‚¬ì´ì¦ˆëŠ” ì¼ë°˜ì ìœ¼ë¡œ timeê³¼ frequencyì˜ resolutionsì„ ì œì–´í•´ ì¤ë‹ˆë‹¤.</p>
<ul>
<li>short-window : ë‚®ì€ frequency resolution, ë†’ì€ time-resolutionì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</li>
<li>Long-window : ë†’ì€ frequency resolutionì„ ê°€ì§€ë©°, ë‚®ì€ time-resolutionì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>
<h3 id="Spectrogram"><a href="#Spectrogram" class="headerlink" title="Spectrogram"></a>Spectrogram</h3><p>Spectrogramì„ ì¶”ì¶œí•˜ëŠ” ë°©ë²•ì„ ê³ ë¯¼í•´ë´…ì‹œë‹¤.ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ëŠ” ì…ë ¥ì‹ í˜¸ì— ëŒ€í•´ì„œ window functionì„ í†µê³¼í•˜ì—¬ window sizeë§Œí¼ sampling ëœ dataë¥¼ ë°›ì•„ì„œ Discrete Fourier Transformì„ ê±°ì¹˜ê²Œ ë©ë‹ˆë‹¤. DFTë¥¼ ê±°ì¹œ ì‹ í˜¸ë“¤ì€ Frequencyì™€ Amplitudeì˜ ì˜ì—­ì„ ê°€ì§€ëŠ” Spectrumì´ ë©ë‹ˆë‹¤. ì´í›„ ì´ë¥¼ 90ë„ë¡œ íšŒì „ì‹œì¼œì„œ, time domainìœ¼ë¡œ stackí•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>Spectrogramì€ Frequency Scaleì— ëŒ€í•´ì„œ Scalingì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤. ì£¼íŒŒìˆ˜ ì˜ì—­ì— Scalingì„ í•˜ëŠ” ì´ìœ ëŠ”, ì¸ê°„ì˜ ì£¼íŒŒìˆ˜ë¥¼ ì¸ì‹í•˜ëŠ” ë°©ì‹ê³¼ ì—°ê´€ì´ ìˆìŠµë‹ˆë‹¤. </p>
<p>ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ëŒì€, ì¸ì ‘í•œ ì£¼íŒŒìˆ˜ë¥¼ í¬ê²Œ êµ¬ë³„í•˜ì§€ ëª»í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” ìš°ë¦¬ì˜ ì¸ì§€ê¸°ê´€ì´ categoricalí•œ êµ¬ë¶„ì„ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë•Œë¬¸ì— ìš°ë¦¬ëŠ” ì£¼íŒŒìˆ˜ë“¤ì˜ Binì˜ ê·¸ë£¹ì„ ë§Œë“¤ê³  ì´ë“¤ì„ í•©í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ, ì£¼íŒŒìˆ˜ ì˜ì—­ì—ì„œ ì–¼ë§ˆë§Œí¼ì˜ ì—ë„ˆì§€ê°€ ìˆëŠ”ì§€ë¥¼ ì°¾ì•„ë³¼ ê²ƒì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œëŠ” ì¸ê°„ì´ ì ì€ ì£¼íŒŒìˆ˜ì— ë” í’ë¶€í•œ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ê¸°ë•Œë¬¸ì—, ì£¼íŒŒìˆ˜ê°€ ì˜¬ë¼ê°ˆìˆ˜ë¡ í•„í„°ì˜ í­ì´ ë†’ì•„ì§€ë©´ì„œ ê³ ì£¼íŒŒëŠ” ê±°ì˜ ê³ ë ¤ë¥¼ ì•ˆí•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ë”°ë¼ì„œ ì•„ë˜ frequency scaleì€ ì–´ë–¤ ë°©ì‹ì„ í†µí•´ ì €ì£¼íŒŒìˆ˜ëŒ€ ì˜ì—­ì„ ê³ ë ¤í•  ê²ƒì´ê°€ì— ëŒ€í•œ ê³ ë¯¼ì´ ë‚¨ì•„ ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="Linear-frequency-scale"><a href="#Linear-frequency-scale" class="headerlink" title="Linear frequency scale"></a>Linear frequency scale</h3><p>ì¼ë°˜ì ìœ¼ë¡œ single tone(ìˆœìŒ)ë“¤ì˜ ë°°ìŒ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ê¸° ì¢‹ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë¶„í¬ê°€ ì €ì£¼íŒŒìˆ˜ ì˜ì—­ì— ê¸°ìš¸ì–´ì ¸(skewed) ìˆìŠµë‹ˆë‹¤.</p>
<h3 id="Mel-Scale"><a href="#Mel-Scale" class="headerlink" title="Mel Scale"></a>Mel Scale</h3><p>ë©œ ìŠ¤í™íŠ¸ëŸ¼ì€ ì£¼íŒŒìˆ˜ ë‹¨ìœ„ë¥¼ ë‹¤ìŒ ê³µì‹ì— ë”°ë¼ ë©œ ë‹¨ìœ„ë¡œ ë°”ê¾¼ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
<p>$$m &#x3D; 2595 \log_{10}\left(1 + \frac{f}{700}\right)$$<br>ì¼ë°˜ì ìœ¼ë¡œëŠ” mel-scaled binì„ FFT sizeë³´ë‹¤ ì¡°ê¸ˆë” ì‘ê²Œ ë§Œë“œëŠ”ê²Œ ì¼ë°˜ì ì…ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># STFT</span></span><br><span class="line">S = librosa.core.stft(audio_np, n_fft=<span class="number">1024</span>, hop_length=<span class="number">512</span>, win_length=<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># phase ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‚ ë¦°ë‹¤.</span></span><br><span class="line">D = np.<span class="built_in">abs</span>(S)**<span class="number">2</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mel spectrogram (512 --&gt; 40)</span></span><br><span class="line">mel_basis = librosa.filters.mel(sr, <span class="number">1024</span>, n_mels=<span class="number">40</span>)</span><br><span class="line">mel_S = np.dot(mel_basis, D)</span><br><span class="line">mel_S.shape</span><br></pre></td></tr></table></figure>




<pre><code>(40, 404)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">128</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_54_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> librosa.display</span><br><span class="line"></span><br><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">256</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_55_0.png" alt="png"></p>
<h3 id="Bark-scale"><a href="#Bark-scale" class="headerlink" title="Bark scale"></a>Bark scale</h3><p>ê·€ê°€ ì¸ì‹í•˜ëŠ” ì£¼íŒŒìˆ˜ì˜ ì˜ì—­ì€ ëŒ€ëµ 20Hz~2000Hz ë¡œ ê°€ì •í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì£¼íŒŒìˆ˜ì— ëŒ€í•œ ì‚¬ëŒì˜ ì¸ì‹ì€ ë¹„ì„ í˜•ì ì…ë‹ˆë‹¤. ê·€ì™€ ë‡Œì˜ ê°€ì²­ëŒ€ì—­ì„ 24ê°œì˜ ëŒ€ì—­ìœ¼ë¡œ ë‚˜ëˆˆê²ƒì„ Barkë¼ê³  í•©ë‹ˆë‹¤! Bark scaleì€ 500Hzì´í•˜ì—ì„œëŠ” 100Hzì˜ ëŒ€ì—­í­ì„ ê°€ì§€ë©°, 500Hz ì´ìƒì—ì„œëŠ” ê° ëŒ€ì—­ì˜ ì¤‘ì‹¬ìˆ˜íŒŒìˆ˜ì˜ ëŒ€ëµ 20%ì— í•´ë‹¹í•˜ëŠ” ëŒ€ì—­í­ì„ ê°€ì§€ê²Œ ë©ë‹ˆë‹¤.</p>
<p><code>20, 100, 200, 300, 400, 510, 630, 770, 920, 1080, 1270, 1480, 1720, 2000, 2320, 2700, 3150, 3700, 4400, 5300, 6400, 7700, 9500, 12000, 15500 ( Hz )</code></p>
<h3 id="Log-compression"><a href="#Log-compression" class="headerlink" title="Log compression"></a>Log compression</h3><p>\(10 * log10(\frac{S}{ref})\)<br>ì˜ ë‹¨ìœ„ë¡œ ì‹ í˜¸ë¥¼ ìŠ¤ì¼€ì¼ë§ í•©ë‹ˆë‹¤. ì´ëŠ” spectrogramì„ ë°ì‹œë²¨ ìœ ë‹›ìœ¼ë¡œ ì „í™˜í•´ ì¤ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#log compression</span></span><br><span class="line">log_mel_S = librosa.power_to_db(mel_S)</span><br><span class="line">log_mel_S.shape</span><br></pre></td></tr></table></figure>




<pre><code>(40, 404)
</code></pre>
<h3 id="Discrete-cosine-transform-DCT"><a href="#Discrete-cosine-transform-DCT" class="headerlink" title="Discrete cosine transform (DCT)"></a>Discrete cosine transform (DCT)</h3><p>DCTëŠ” nê°œì˜ ë°ì´í„°ë¥¼ nê°œì˜ ì½”ì‚¬ì¸ í•¨ìˆ˜ì˜ í•©ìœ¼ë¡œ í‘œí˜„í•˜ì—¬ ë°ì´í„°ì˜ ì–‘ì„ ì¤„ì´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. </p>
<ul>
<li>ì € ì£¼íŒŒìˆ˜ì— ì—ë„ˆì§€ê°€ ì§‘ì¤‘ë˜ê³  ê³  ì£¼íŒŒìˆ˜ ì˜ì—­ì— ì—ë„ˆì§€ê°€ ê°ì†Œí•©ë‹ˆë‹¤.</li>
</ul>
<p>Filter BankëŠ” ëª¨ë‘ Overlapping ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— Filter Bank ì—ë„ˆì§€ë“¤ ì‚¬ì´ì— ìƒê´€ê´€ê³„ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤. DCTëŠ” ì—ë„ˆì§€ë“¤ ì‚¬ì´ì— ì´ëŸ¬í•œ ìƒê´€ê´€ê³„ë¥¼ ë¶„ë¦¬ í•´ì£¼ëŠ” ì—­í™œì„ í•´ì¤ë‹ˆë‹¤.</p>
<p>í•˜ì§€ë§Œ ì—¬ê¸°ì„œ 26ê°œ DCT Coefficient ë“¤ ì¤‘ 12ë§Œ ë‚¨ê²¨ì•¼ í•˜ëŠ”ë°, ê·¸ ì´ìœ ëŠ” DCT Coefficient ê°€ ë§ìœ¼ë©´, Filter Bank ì—ë„ˆì§€ì˜ ë¹ ë¥¸ ë³€í™”ë¥¼ ë‚˜íƒ€ë‚´ê²Œ ë˜ê³ , ì´ê²ƒì€ ìŒì„±ì¸ì‹ì˜ ì„±ëŠ¥ì„ ë‚®ì¶”ê²Œ ë©ë‹ˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mfcc (DCT)</span></span><br><span class="line">mfcc = librosa.feature.mfcc(S=log_mel_S, n_mfcc=<span class="number">13</span>)</span><br><span class="line">mfcc = mfcc.astype(np.float32)    <span class="comment"># to save the memory (64 to 32 bits)</span></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(mfcc)</span><br></pre></td></tr></table></figure>




<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f3a8975cc88&gt;
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_61_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mfcc = librosa.feature.mfcc(S=log_S, n_mfcc=<span class="number">13</span>)</span><br><span class="line">delta2_mfcc = librosa.feature.delta(mfcc, order=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(delta2_mfcc.shape)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(delta2_mfcc)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;MFCC coeffs&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;MFCC&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure>

<pre><code>(13, 148)
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_62_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">change_pitch</span>(<span class="params">data, sr</span>):</span><br><span class="line">    y_pitch = data.copy()</span><br><span class="line">    bins_per_octave = <span class="number">12</span></span><br><span class="line">    pitch_pm = <span class="number">2</span></span><br><span class="line">    pitch_change = pitch_pm * <span class="number">2</span> * (np.random.uniform())</span><br><span class="line">    y_pitch = librosa.effects.pitch_shift(y_pitch.astype(<span class="string">&#x27;float64&#x27;</span>), sr, n_steps=pitch_change,</span><br><span class="line">                                          bins_per_octave=bins_per_octave)</span><br><span class="line">    <span class="keyword">return</span> y_pitch</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">waveform_aug</span>(<span class="params">waveform,sr</span>):</span><br><span class="line">  y = change_pitch(waveform, sr)</span><br><span class="line">  fig = plt.figure(figsize = (<span class="number">14</span>,<span class="number">5</span>))</span><br><span class="line">  librosa.display.waveplot(y, sr=sr)</span><br><span class="line">  ipd.display(ipd.Audio(data=y, rate=sr))</span><br><span class="line">  <span class="keyword">return</span> y, sr</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipd.display(ipd.Audio(data=audio_np, rate=sr))</span><br><span class="line">y, sr = waveform_aug(audio_np, <span class="number">16000</span>)</span><br></pre></td></tr></table></figure>



<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_66_2.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">S = librosa.feature.melspectrogram(audio_np, sr=sr, n_mels = <span class="number">128</span>)</span><br><span class="line">log_S = librosa.power_to_db(S, ref=np.<span class="built_in">max</span>)</span><br><span class="line">plt.figure(figsize=(<span class="number">12</span>,<span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(log_S, sr=sr, x_axis=<span class="string">&#x27;time&#x27;</span>, y_axis=<span class="string">&#x27;mel&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Mel power sepctrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+02.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_67_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.uniform(low=<span class="number">1.5</span>, high=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>




<pre><code>2.6892527992385458
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">value_aug</span>(<span class="params">data</span>):</span><br><span class="line">    y_aug = data.copy()</span><br><span class="line">    dyn_change = np.random.uniform(low=<span class="number">1.5</span>, high=<span class="number">3</span>)</span><br><span class="line">    y_aug = y_aug * dyn_change</span><br><span class="line">    <span class="keyword">return</span> y_aug</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add_noise</span>(<span class="params">data</span>):</span><br><span class="line">    noise = np.random.randn(<span class="built_in">len</span>(data))</span><br><span class="line">    data_noise = data + <span class="number">0.005</span> * noise</span><br><span class="line">    <span class="keyword">return</span> data_noise</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hpss</span>(<span class="params">data</span>):</span><br><span class="line">    y_harmonic, y_percussive = librosa.effects.hpss(data.astype(<span class="string">&#x27;float64&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> y_harmonic, y_percussive</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> np.roll(data, <span class="number">1600</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">stretch</span>(<span class="params">data, rate=<span class="number">1</span></span>):</span><br><span class="line">    input_length = <span class="built_in">len</span>(data)</span><br><span class="line">    streching = librosa.effects.time_stretch(data, rate)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(streching) &gt; input_length:</span><br><span class="line">        streching = streching[:input_length]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        streching = np.pad(streching, (<span class="number">0</span>, <span class="built_in">max</span>(<span class="number">0</span>, input_length - <span class="built_in">len</span>(streching))), <span class="string">&quot;constant&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> streching</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">change_pitch_and_speed</span>(<span class="params">data</span>):</span><br><span class="line">    y_pitch_speed = data.copy()</span><br><span class="line">    <span class="comment"># you can change low and high here</span></span><br><span class="line">    length_change = np.random.uniform(low=<span class="number">0.8</span>, high=<span class="number">1</span>)</span><br><span class="line">    speed_fac = <span class="number">1.0</span> / length_change</span><br><span class="line">    tmp = np.interp(np.arange(<span class="number">0</span>, <span class="built_in">len</span>(y_pitch_speed), speed_fac), np.arange(<span class="number">0</span>, <span class="built_in">len</span>(y_pitch_speed)), y_pitch_speed)</span><br><span class="line">    minlen = <span class="built_in">min</span>(y_pitch_speed.shape[<span class="number">0</span>], tmp.shape[<span class="number">0</span>])</span><br><span class="line">    y_pitch_speed *= <span class="number">0</span></span><br><span class="line">    y_pitch_speed[<span class="number">0</span>:minlen] = tmp[<span class="number">0</span>:minlen]</span><br><span class="line">    <span class="keyword">return</span> y_pitch_speed</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data_noise = add_noise(audio_np)</span><br><span class="line">data_roll = shift(audio_np)</span><br><span class="line">data_stretch = stretch(audio_np)</span><br><span class="line">pitch_speed = change_pitch_and_speed(audio_np)</span><br><span class="line">value = value_aug(audio_np)</span><br><span class="line">y_harmonic, y_percussive = hpss(audio_np)</span><br><span class="line">y_shift = shift(audio_np)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(data_noise, rate=fs)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(magnitude,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_32_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mel_s = librosa.feature.melspectrogram(y=y, sr=sr)</span><br><span class="line"><span class="built_in">print</span>(mel_s.shape)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(mel_s,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>(128, 96)
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_33_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mfccs = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(mfccs.shape)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line">librosa.display.specshow(mfccs, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.colorbar()</span><br><span class="line">plt.title(<span class="string">&#x27;MFCC&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<pre><code>(40, 96)
</code></pre>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_34_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">librosa.display.specshow(librosa.amplitude_to_db(mfccs,</span><br><span class="line">                                                  ref=np.<span class="built_in">max</span>),</span><br><span class="line">                          y_axis=<span class="string">&#x27;log&#x27;</span>, x_axis=<span class="string">&#x27;time&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Power spectrogram&#x27;</span>)</span><br><span class="line">plt.colorbar(<span class="built_in">format</span>=<span class="string">&#x27;%+2.0f dB&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-9/output_35_0.png" alt="png"></p>
<h4 id="ë“¤ë¦¬ëŠ”-ì†Œë¦¬-ë°°ê²½ì¡ìŒ-ëª©ì†Œë¦¬"><a href="#ë“¤ë¦¬ëŠ”-ì†Œë¦¬-ë°°ê²½ì¡ìŒ-ëª©ì†Œë¦¬" class="headerlink" title="ë“¤ë¦¬ëŠ” ì†Œë¦¬ &#x3D; ë°°ê²½ì¡ìŒ + ëª©ì†Œë¦¬"></a>ë“¤ë¦¬ëŠ” ì†Œë¦¬ &#x3D; ë°°ê²½ì¡ìŒ + ëª©ì†Œë¦¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">filename_wav = <span class="string">&quot;./wav/voice.wav&quot;</span></span><br><span class="line">filename_noise = <span class="string">&quot;./wav/cafe_noise.wav&quot;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">ipd.Audio(filename_wav)</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">ipd.Audio(filename_noise)</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">data_wav, sr_wav = librosa.load(filename_wav, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line">data_noise, sr_noise = librosa.load(filename_noise, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data_wav.shape)</span><br><span class="line"><span class="built_in">print</span>(data_noise.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ì „ì²´ì ìœ¼ë¡œ ë“¤ë¦¬ëŠ” ì†Œë¦¬ëŠ” ì†Œë¦¬ì˜ í•©( ë°°ê²½ìŒ + ëª©ì†Œë¦¬ )</span></span><br><span class="line">data_wav_noise = data_wav[:] + data_noise[:<span class="built_in">len</span>(data_wav)]</span><br><span class="line"></span><br><span class="line">pos=<span class="number">10</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;wav: &#123;:.8f&#125;, noise &#123;:.8f&#125;, wav+noise: &#123;:.8f&#125;&quot;</span>.<span class="built_in">format</span>(data_wav[pos], data_noise[pos], data_wav_noise[pos]))</span><br></pre></td></tr></table></figure>

<pre><code>(48944,)
(1044712,)
wav: -0.00009155, noise -0.00003052, wav + noise: -0.00012207
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(data_wav_noise, rate=<span class="number">16000</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-12-03T08:02:23.000Z" title="2020. 12. 3. ì˜¤í›„ 5:02:23">2020-12-03</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:50:15.602Z" title="2024. 12. 3. ì˜¤í›„ 2:50:15">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">8 minutes read (About 1229 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/12/03/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/">ë”¥ëŸ¬ë‹-ì…ë¬¸í•˜ê¸°-8</a></p><div class="content"><h3 id="ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-í•´ë³´ê¸°"><a href="#ì˜¤ë””ì˜¤-ë”¥ëŸ¬ë‹-í•´ë³´ê¸°" class="headerlink" title="ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ í•´ë³´ê¸°"></a>ì˜¤ë””ì˜¤ ë”¥ëŸ¬ë‹ í•´ë³´ê¸°</h3><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul>
<li><p>Digital Signal Processing Lecture <a target="_blank" rel="noopener" href="https://github.com/spatialaudio/digital-signal-processing-lecture">https://github.com/spatialaudio/digital-signal-processing-lecture</a> </p>
</li>
<li><p>Python for Signal Processing (unipingco) <a target="_blank" rel="noopener" href="https://github.com/unpingco/Python-for-Signal-Processing">https://github.com/unpingco/Python-for-Signal-Processing</a> </p>
</li>
<li><p>Audio for Deep Learning (ë‚¨ê¸°í˜„ë‹˜) <a target="_blank" rel="noopener" href="https://tykimos.github.io/2019/07/04/ISS_2nd_Deep_Learning_Conference_All_Together/">https://tykimos.github.io/2019/07/04/ISS_2nd_Deep_Learning_Conference_All_Together/</a> </p>
</li>
<li><p>ì˜¤ë””ì˜¤ ì „ì²˜ë¦¬ ì‘ì—…ì„ ìœ„í•œ ì—°ìŠµ (ë°•ìˆ˜ì² ë‹˜) <a target="_blank" rel="noopener" href="https://github.com/scpark20/audio-preprocessing-practice">https://github.com/scpark20/audio-preprocessing-practice</a> </p>
</li>
<li><p>Musical Applications of Machine Learning <a target="_blank" rel="noopener" href="https://mac.kaist.ac.kr/~juhan/gct634/">https://mac.kaist.ac.kr/~juhan/gct634/</a> </p>
</li>
<li><p>Awesome audio study materials for Korean (ìµœê·¼ìš°ë‹˜) <a target="_blank" rel="noopener" href="https://github.com/keunwoochoi/awesome-audio-study-materials-for-korean">https://github.com/keunwoochoi/awesome-audio-study-materials-for-korean</a></p>
</li>
<li><p>T Academy(ì¶œì²˜) <a target="_blank" rel="noopener" href="https://tacademy.skplanet.com/live/player/onlineLectureDetail.action?seq=178">https://tacademy.skplanet.com/live/player/onlineLectureDetail.action?seq=178</a></p>
</li>
</ul>
<h2 id="1-Digital-Signal-Processing"><a href="#1-Digital-Signal-Processing" class="headerlink" title="1. Digital Signal Processing"></a>1. Digital Signal Processing</h2><p>ì†Œë¦¬ signalë¥¼ ì–´ë– í•œ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ í‘œí˜„í•˜ë©°, ì†Œë¦¬ì™€ ê´€ë ¨ëœ taskë¥¼ í•´ê²°í•˜ëŠ”ë° ìˆìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì†Œë¦¬ëŠ” ì–´ë– í•œ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆì„ê¹Œìš”?</p>
<h3 id="Sound"><a href="#Sound" class="headerlink" title="Sound?"></a>Sound?</h3><p>ì†Œë¦¬ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì§„ë™ìœ¼ë¡œ ì¸í•œ ê³µê¸°ì˜ ì••ì¶•ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì••ì¶•ì´ ì–¼ë§ˆë‚˜ ë¬ëŠëƒì— ë”°ë¼ì„œ í‘œí˜„ë˜ê²ƒì´ ë°”ë¡œ Wave(íŒŒë™)ì¸ë°ìš”. íŒŒë™ì€ ì§„ë™í•˜ë©° ê³µê°„&#x2F;ë§¤ì§ˆì„ ì „íŒŒí•´ ë‚˜ê°€ëŠ” í˜„ìƒì…ë‹ˆë‹¤. ì§ˆëŸ‰ì˜ ì´ë™ì€ ì—†ì§€ë§Œ ì—ë„ˆì§€&#x2F;ìš´ë™ëŸ‰ì˜ ìš´ë°˜ì€ ì¡´ì¬í•©ë‹ˆë‹¤.</p>
<p>Waveì—ì„œ ì €í¬ê°€ ì–»ì„ìˆ˜ ìˆëŠ” ì •ë³´ëŠ” í¬ê²Œ 3ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>Phase(Degress of displacement) : ìœ„ìƒ</li>
<li>Amplitude(Intensity) : ì§„í­</li>
<li>Frequency : ì£¼íŒŒìˆ˜</li>
</ul>
<h3 id="Sampling"><a href="#Sampling" class="headerlink" title="Sampling"></a>Sampling</h3><p>ìƒ˜í”Œë§ì€ ë¬´ì—‡ì¼ê¹Œìš”?? ì•„ë‚ ë¡œê·¸ ì •ë³´ë¥¼ ì˜ê²Œ ìª¼ê°œì„œ discreteí•œ ë””ì§€í„¸ ì •ë³´ë¡œ í‘œí˜„í•´ì•¼í•©ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ë¬´í•œí•˜ê²Œ ìª¼ê°œì„œ ì €ì¥í• ìˆ˜ ì—†ìœ¼ë‹ˆ, ì–´ë–¤ ê¸°ì¤€ì„ ê°€ì§€ê³  ì•„ë‚ ë¡œê·¸ ì •ë³´ë¥¼ ìª¼ê°œì„œ ëŒ€í‘œê°’ì„ ì·¨í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p><code>Convert into a sqeuence of binary values via Sampling and Quantization</code></p>
<h3 id="1-1-Time-domain"><a href="#1-1-Time-domain" class="headerlink" title="1.1. Time domain"></a>1.1. Time domain</h3><p>ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ì•„ë‚ ë¡œê·¸ ì‹œê·¸ë„ì„ ìª¼ê°œê²Œ ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. Samplingì„ í†µí•˜ì—¬ ì»´í“¨í„°ëŠ” ì†Œë¦¬ sequenceë¥¼ binary valueë¡œ ë°›ì•„ë“œë¦¬ê²Œ ë©ë‹ˆë‹¤.</p>
<p><strong>Sampling rate : ì–¼ë§ˆë‚˜ ì˜ê²Œ ìª¼ê°¤ ê²ƒì¸ê°€?</strong><br><br>ì˜ê°œ ìª¼ê°¤ìˆ˜ë¡ ì›ë³¸ ë°ì´í„°ì™€ ê±°ì´ ê°€ê¹Œì›Œì§€ê¸° ë–„ë¬¸ì— ì¢‹ì§€ë§Œ Dataì˜ ì–‘ì´ ì¦ê°€í•˜ê²Œ ë©ë‹ˆë‹¤. ë§Œì•½ ë„ˆë¬´ í¬ê²Œ ìª¼ê°œê²Œ ëœë‹¤ë©´, ì›ë³¸ ë°ì´í„°ë¡œ reconstructí•˜ê¸° í˜ë“¤ì–´ ì§ˆ ê²ƒì…ë‹ˆë‹¤.</p>
<p><strong>Sampling theorem</strong><br><br>ìƒ˜í”Œë§ ë ˆì´íŠ¸ê°€ ìµœëŒ€ frequencyì˜ 2ë°° ë³´ë‹¤ ì»¤ì ¸ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.<br>\( f_{s} &gt; 2f_{m} \) ì—¬ê¸°ì„œ \(f_{s}\)ëŠ” sampling rate, ê·¸ë¦¬ê³  \(f_{m}\)ì€ maximum frequencyë¥¼ ë§í•©ë‹ˆë‹¤.</p>
<ul>
<li>Nyqusit frequency &#x3D; \(f_{s}&#x2F;2\), sampling rateì˜ ì ˆë°˜ì…ë‹ˆë‹¤.</li>
</ul>
<p>ì¼ë°˜ì ìœ¼ë¡œ Samplingì€ ì¸ê°„ì˜ ì²­ê° ì˜ì—­ì— ë§ê²Œ í˜•ì„±ì´ ë©ë‹ˆë‹¤.</p>
<ul>
<li>Audio CD : 44.1 kHz(44100 sample&#x2F;second)</li>
<li>Speech communication : 8 kHz(8000 sample&#x2F;second)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># library load</span></span><br><span class="line"><span class="keyword">import</span> soundfile <span class="keyword">as</span> sf</span><br><span class="line"><span class="keyword">import</span> librosa</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename = <span class="string">&quot;./wav/voice.wav&quot;</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># íŒŒì¼ ë¡œë“œ ë°©ë²• 1</span></span><br><span class="line">y, sr = sf.read(filename, dtype=<span class="string">&#x27;int16&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sample Rate: &quot;</span>, sr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;DATA: &quot;</span>, <span class="built_in">type</span>(y), y.shape, <span class="built_in">len</span>(y), y)</span><br><span class="line"></span><br><span class="line">dur = <span class="built_in">len</span>(y) / sr</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;dur : &quot;</span>, dur)</span><br></pre></td></tr></table></figure>

<pre><code>Sample Rate:  16000
DATA:  &lt;class &#39;numpy.ndarray&#39;&gt; (48944,) 48944 [ -9   1  -5 ... -20 -16 -24]
dur :  3.059
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># íŒŒì¼ ë¡œë“œ ë°©ë²• 2</span></span><br><span class="line">y, sr = librosa.load(filename, mono=<span class="literal">True</span>, sr=<span class="number">16000</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sample Rate: &quot;</span>, sr)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;DATA: &quot;</span>, <span class="built_in">type</span>(y), y.shape, y)</span><br><span class="line">dur = <span class="built_in">len</span>(y) / sr</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;dur : &quot;</span>, dur)</span><br></pre></td></tr></table></figure>

<pre><code>Sample Rate:  16000
DATA:  &lt;class &#39;numpy.ndarray&#39;&gt; (48944,) [-2.7465820e-04  3.0517578e-05 -1.5258789e-04 ... -6.1035156e-04
 -4.8828125e-04 -7.3242188e-04]
dur :  3.059
</code></pre>
<h3 id="Resampling"><a href="#Resampling" class="headerlink" title="Resampling"></a>Resampling</h3><p>ìƒ˜í”Œë§ëœ ë°ì´í„°ë¥¼ ë‹¤ì‹œê¸ˆ ë” ë†’ì€ sampling rate í˜¹ì€ ë” ë‚®ì€ sampling rateë¡œ ë‹¤ì‹œ ìƒ˜í”Œë§í• ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•ŒëŠ” ì¼ë°˜ì ìœ¼ë¡œ interpolation(ë³´ê°„)ì„ í• ë•ŒëŠ” low-pass filterë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.(Windowed sinc function)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> IPython.display <span class="keyword">as</span> ipd</span><br><span class="line">y_8k = librosa.resample(y, sr, <span class="number">8000</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipd.Audio(y_8k, rate=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(y_8k)</span><br></pre></td></tr></table></figure>




<pre><code>24472
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># duration</span></span><br><span class="line"><span class="built_in">len</span>(y_8k)/<span class="number">8000</span></span><br></pre></td></tr></table></figure>




<pre><code>3.059
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_2k = librosa.resample(y, sr, <span class="number">4000</span>)</span><br><span class="line">ipd.Audio(y_2k, rate=<span class="number">2000</span>)</span><br></pre></td></tr></table></figure>








<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">len</span>(y_2k)</span><br></pre></td></tr></table></figure>




<pre><code>12236
</code></pre>
<h3 id="Nomalization-Quantization"><a href="#Nomalization-Quantization" class="headerlink" title="Nomalization &amp; Quantization"></a>Nomalization &amp; Quantization</h3><p>ì‹œê°„ì˜ ê¸°ì¤€ì´ ì•„ë‹Œ ì‹¤ì œ amplitudeì˜ real valued ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‹œê·¸ë„ì˜ ê°’ì„ ì¡°ì ˆí•©ë‹ˆë‹¤. Amplitudeë¥¼ ì´ì‚°ì ì¸ êµ¬ê°„ìœ¼ë¡œ ë‚˜ëˆ„ê³ , signal ë°ì´í„°ì˜ Amplitudeë¥¼ ë°˜ì˜¬ë¦¼í•˜ê²Œ ë©ë‹ˆë‹¤.</p>
<p>ê·¸ë ‡ë‹¤ë©´ ì´ì‚°ì ì¸ êµ¬ê°„ì€ ì–´ë–»ê²Œ ë‚˜ëˆŒìˆ˜ ìˆì„ê¹Œìš”?, bitì˜ ë¹„íŠ¸ì— ì˜í•´ì„œ ê²°ì •ë©ë‹ˆë‹¤. </p>
<ul>
<li>B bitì˜ Quantization : \(-2^{B-1}\) ~ \(2^{B-1}-1\)</li>
<li>Audio CDì˜ Quantization (16 bits) : \(-2^{15}\) ~ \(2^{15}-1\)</li>
<li>ìœ„ ê°’ë“¤ì€ ë³´í†µ -1.0 ~ 1.0  ì˜ì—­ìœ¼ë¡œ scalingë˜ê¸°ë„ í•©ë‹ˆë‹¤.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Normalize</span></span><br><span class="line">normed_wav = y / <span class="built_in">max</span>(np.<span class="built_in">abs</span>(y))</span><br><span class="line">ipd.Audio(normed_wav, rate=sr)</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#quantization í•˜ë©´ ìŒì§ˆì€ ë–¨ì–´ì§€ì§€ë§Œ lightí•œ ìë£Œí˜•ì´ ëœë‹¤.</span></span><br><span class="line">Bit = <span class="number">8</span></span><br><span class="line">max_value = <span class="number">2</span> ** (Bit-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">quantized_8_wav = normed_wav * max_value</span><br><span class="line">quantized_8_wav = np.<span class="built_in">round</span>(quantized_8_wav).astype(<span class="built_in">int</span>)</span><br><span class="line">quantized_8_wav = np.clip(quantized_8_wav, -max_value, max_value-<span class="number">1</span>)</span><br><span class="line">ipd.Audio(quantized_8_wav, rate=sr)</span><br></pre></td></tr></table></figure>



<h3 id="mu-law-encoding"><a href="#mu-law-encoding" class="headerlink" title="mu-law encoding"></a>mu-law encoding</h3><p>ì‚¬ëŒì˜ ê·€ëŠ” ì†Œë¦¬ì˜ amplitudeì— ëŒ€í•´ logì ìœ¼ë¡œ ë°˜ì‘í•©ë‹ˆë‹¤. ì¦‰, ì‘ì€ì†Œë¦¬ì˜ ì°¨ì´ëŠ” ì˜ì¡ì•„ë‚´ëŠ”ë° ë°˜í•´ ì†Œë¦¬ê°€ ì»¤ì§ˆìˆ˜ë¡ ê·¸ ì°¨ì´ë¥¼ ì˜ ëŠë¼ì§€ ëª»í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ íŠ¹ì„±ì„ waveê°’ì„ í‘œí˜„í•˜ëŠ”ë° ë°˜ì˜í•´ì„œ ì‘ì€ê°’ì—ëŠ” ë†’ì€ ë¶„ë³„ë ¥(high resolution)ì„, í°ê°’ë¼ë¦¬ëŠ” ë‚®ì€ ë¶„ë³„ë ¥(low resolution)ì„ ê°–ë„ë¡ í•©ë‹ˆë‹¤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mu_law</span>(<span class="params">x, mu=<span class="number">255</span></span>):</span><br><span class="line">    <span class="keyword">return</span> np.sign(x) * np.log(<span class="number">1</span> + mu * np.<span class="built_in">abs</span>(x)) / np.log(<span class="number">1</span> + mu)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = np.linspace(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">1000</span>)</span><br><span class="line">x_mu = mu_law(x)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=[<span class="number">6</span>, <span class="number">4</span>])</span><br><span class="line">plt.plot(x)</span><br><span class="line">plt.plot(x_mu)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%ED%95%98%EA%B8%B0-8/output_18_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wav_mulaw = mu_law(normed_wav)</span><br><span class="line">ipd.Audio(wav_mulaw, rate=sr)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>to be continuedâ€¦<br>ë’·ì¥ì—ì„œ ê³„ì†ë©ë‹ˆë‹¤.</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-11-29T17:54:54.000Z" title="2020. 11. 30. ì˜¤ì „ 2:54:54">2020-11-30</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:51:38.814Z" title="2024. 12. 3. ì˜¤í›„ 2:51:38">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">6 minutes read (About 909 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/30/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/">ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„7</a></p><div class="content"><h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-7"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-7" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-7"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-7</h2><h3 id="í•©ì„±ê³±-Convolution"><a href="#í•©ì„±ê³±-Convolution" class="headerlink" title="í•©ì„±ê³±(Convolution)"></a>í•©ì„±ê³±(Convolution)</h3><p>  Convolution?<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_1.png" alt="conv">  </p>
<p>  <strong>ì •ì˜</strong><br>  í•©ì„±ê³± ì—°ì‚°ì€ ë‘ í•¨ìˆ˜ f, g ê°€ìš´ë° í•˜ë‚˜ì˜ í•¨ìˆ˜ë¥¼ ë°˜ì „(reverse), ì „ì´(shift)ì‹œí‚¨ ë‹¤ìŒ, ë‹¤ë¥¸ í•˜ë‚˜ì˜ í•¨ìˆ˜ì™€ ê³±í•œ ê²°ê³¼ë¥¼ ì ë¶„í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì´ë¥¼ ìˆ˜í•™ ê¸°í˜¸ë¡œ í‘œì‹œí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/1.PNG" alt="1"></p>
<p>  ë˜í•œ g í•¨ìˆ˜ ëŒ€ì‹ ì— f í•¨ìˆ˜ë¥¼ ë°˜ì „, ì „ì´ ì‹œí‚¤ëŠ” ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ í‘œì‹œí•  ìˆ˜ë„ ìˆë‹¤. ì´ ë‘ ì—°ì‚°ì€ í˜•íƒœëŠ” ë‹¤ë¥´ì§€ë§Œ ê°™ì€ ê²°ê³¼ê°’ì„ ê°–ëŠ”ë‹¤.<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/2.PNG" alt="2"></p>
<p>  ìœ„ì˜ ì ë¶„ì—ì„œ ì ë¶„ êµ¬ê°„ì€ í•¨ìˆ˜ fì™€ gê°€ ì •ì˜ëœ ë²”ìœ„ì— ë”°ë¼ì„œ ë‹¬ë¼ì§„ë‹¤.</p>
<p>  ë˜í•œ ë‘ í™•ë¥  ë³€ìˆ˜ Xì™€ Yê°€ ìˆì„ ë•Œ ê°ê°ì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ë¥¼ fì™€ gë¼ê³  í•˜ë©´, X+Yì˜ í™•ë¥  ë°€ë„ í•¨ìˆ˜ëŠ” \(f * g\)ë¡œ í‘œì‹œí•  ìˆ˜ ìˆë‹¤. â€“ <a target="_blank" rel="noopener" href="https://ko.wikipedia.org/wiki/%ED%95%A9%EC%84%B1%EA%B3%B1">Wikipedia</a></p>
<blockquote>
<p>ë¬´ì—‡ì¸ì§€ ëª¨ë¥´ê² ì£ ? ì‰½ê²Œ ë§í•˜ìë©´<br>  ê¸°ì¡´ MLPì—ì„œëŠ” ì´ë¯¸ì§€ê°€ ì‚´ì§ì´ë¼ë„ íšŒì „ì´ ë˜ê±°ë‚˜ ìœ„ì¹˜ ì´ë™ì´ ìˆë‹¤ë©´ ì‹ ê²½ë§ ìì²´ë¥¼ ë‹¤ì‹œ í•™ìŠµí•´ì•¼ í•˜ì§€ë§Œ<br>  CNNì€ ì´ë¯¸ì§€ì˜ ë³€í™”ê°€ ìˆì–´ë„ ì¬í•™ìŠµ ì—†ì–´ë„ ê°€ëŠ¥í•¨.</p>
</blockquote>
<p>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_2.PNG" alt="conv2"><br>  ëª¨ë“  pixelì„ ë¹„êµí•  ê²Œ ì ˆëŒ€ ì•„ë‹˜. Feature ì¶”ì¶œì— ì¤‘ì ì„ ë‘ .</p>
<p>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_3.PNG" alt="conv3">   </p>
<blockquote>
<p>ì‚¬ì§„ì— ë³´ì´ëŠ” \(C_in * C_out\)ë²ˆì˜ í•©ì„±ê³± ì—°ì‚° biasëŠ” í•˜ë‚˜ì˜ ë²¡í„°</p>
</blockquote>
<p>  Filter(kernel)ì˜ í¬ê¸°ì— ë”°ë¼ ì˜ìƒì˜ í¬ê¸°ê°€ ì¤„ì–´ë“œëŠ” ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ paddingì„ ì“´ë‹¤.<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_4.PNG" alt="conv4"><br>  í¬ê¸°ê°€ (2N + 1)ì¸ ì»¤ë„ì— ìƒí•˜ì¢Œìš°ì— Nê°œ Zero paddingì„ í•´ì£¼ë©´ ëœë‹¤.</p>
<p>  Sliding Window ë°©ì‹ìœ¼ë¡œ ì»¤ë„ì´ ì´ë™ë˜ëŠ”ë° ê·¸ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ë ¤ë©´ Strideë¥¼ ì“´ë‹¤.<br>  ë„ˆë¬´ í¬ë©´ ì¶œë ¥ Feature Mapì´ ê³¼ë„í•˜ê²Œ ì¤„ì–´ë“œëŠ” ê²½ìš°ê°€ ë°œìƒí•œë‹¤.</p>
<h3 id="ë³´ë‹¤-íš¨ìœ¨ì ì¸-Conv-ì—°ì‚°ì„-í•˜ê¸°-ìœ„í•´ì„œëŠ”-1x1-Convë¥¼-ë„£ëŠ”ë‹¤"><a href="#ë³´ë‹¤-íš¨ìœ¨ì ì¸-Conv-ì—°ì‚°ì„-í•˜ê¸°-ìœ„í•´ì„œëŠ”-1x1-Convë¥¼-ë„£ëŠ”ë‹¤" class="headerlink" title="ë³´ë‹¤ íš¨ìœ¨ì ì¸ Conv ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” 1x1 Convë¥¼ ë„£ëŠ”ë‹¤"></a>ë³´ë‹¤ íš¨ìœ¨ì ì¸ Conv ì—°ì‚°ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” 1x1 Convë¥¼ ë„£ëŠ”ë‹¤</h3><p>  ì—°ì‚°ëŸ‰, íŒŒë¼ë¯¸í„° ê°œìˆ˜ë¥¼ ì¤„ì´ê¸° ìœ„í•´ BottleNeck êµ¬ì¡°ë¥¼ í™œìš©í•œë‹¤.<br>  í•˜í•„ 1x1 ??<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%847/conv_5.PNG" alt="conv5"><br>  3x3 filter í•œê°œì™€ 1x1 + 3x3 parameter ë¹„êµ</p>
<p>  ê·¸ë˜ë„ ëª¨ë¥´ê² ë‹¤ë©´??</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random((<span class="number">3</span>, <span class="number">3</span>)).shape == (np.random((<span class="number">3</span>, <span class="number">1</span>)) * np.random((<span class="number">1</span>, <span class="number">3</span>)).shape)</span><br><span class="line">&gt;&gt; <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># keras</span></span><br><span class="line"><span class="comment"># k - kernel_size(ex. 3, 5, 7...)</span></span><br><span class="line"><span class="comment"># n_filter - number of filters/channels í•„í„° ê°¯ìˆ˜</span></span><br><span class="line">conv1_1 = Conv(n_filters, (<span class="number">1</span>, k))(input_1)</span><br><span class="line">conv1_2 = Conv(n_filters, (k, <span class="number">1</span>))(conv1_1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ì™œ ë³‘ëª©?</span></span><br><span class="line">conv2 = Conv2D(<span class="number">96</span>, (<span class="number">1</span>, <span class="number">1</span>), ...)(conv1) </span><br><span class="line"><span class="comment"># ì¤„ì˜€ë‹¤ê°€(receptive FieldëŠ” ê·¸ëŒ€ë¡œ, Feature mapì„ ë¯¸ë¦¬ ì¤„ì„.)</span></span><br><span class="line">conv3 = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv2) </span><br><span class="line">conv4 = Conv2D(<span class="number">128</span>, (<span class="number">1</span>, <span class="number">1</span>), ...)(conv3) <span class="comment"># ë‹¤ì‹œ ëŠ˜ë¦¼</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>  í•­ë“±í–‰ë ¬ì„ ë– ì˜¬ë¦¬ë©´ ì´í•´ê°€ ê°ˆê²ƒì´ë‹¤.</p>
<h3 id="CNN-ë§Œë“¤ì—ˆëŠ”ë°-ë„ˆë¬´-ëŠë¦¬ë„¤-ì–´ë–»ê²Œ-í•˜ë©´-ë¹ ë¥´ê²Œ-í• -ìˆ˜-ìˆì„ê¹Œâ€¦"><a href="#CNN-ë§Œë“¤ì—ˆëŠ”ë°-ë„ˆë¬´-ëŠë¦¬ë„¤-ì–´ë–»ê²Œ-í•˜ë©´-ë¹ ë¥´ê²Œ-í• -ìˆ˜-ìˆì„ê¹Œâ€¦" class="headerlink" title="CNN ë§Œë“¤ì—ˆëŠ”ë° ë„ˆë¬´ ëŠë¦¬ë„¤? ì–´ë–»ê²Œ í•˜ë©´ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆì„ê¹Œâ€¦"></a>CNN ë§Œë“¤ì—ˆëŠ”ë° ë„ˆë¬´ ëŠë¦¬ë„¤? ì–´ë–»ê²Œ í•˜ë©´ ë¹ ë¥´ê²Œ í•  ìˆ˜ ìˆì„ê¹Œâ€¦</h3><p>  Conv filterë¥¼ ë” ë„“ê²Œ ì“´ë‹¤. â€“&gt; GPU ì—°ì‚°ì´ ì‰¬ì›Œì§„ë‹¤  </p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ì´ë ‡ê²Œ ë˜ì–´ìˆëŠ” ê±¸</span></span><br><span class="line">conv = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br><span class="line">conv = Conv2D(<span class="number">96</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br><span class="line"><span class="comment"># ì•„ë˜ì²˜ëŸ¼ ë°”ê¾¼ë‹¤.</span></span><br><span class="line">conv = Conv2D(<span class="number">128</span>, (<span class="number">3</span>, <span class="number">3</span>), ...)(conv)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>GPUëŠ” ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— í•„í„° ê°¯ìˆ˜ë¥¼ ëŠ˜ë¦¬ë©´ ë”ìš± ë¹¨ë¼ì§„ë‹¤.<br>  ì‰½ê²Œ ë§í•˜ë©´ 96ê°œì”© ë‘ë²ˆë³´ë‹¤ 128ê°œì”© í•œë²ˆì´ ë” ë¹ ë¥´ë‹¤.  </p>
</blockquote>
<p>  ì„¤ëª….</p>
<ol>
<li>96 &#x2F;&#x2F; 3 &#x3D; 32</li>
<li>2- layerì„ 1- layerë¡œ ë°”ê¿€ë•</li>
<li>32 &#x2F;&#x2F; 2 &#x3D; 16</li>
<li>16^0.5 &#x3D; 4</li>
<li>4 * 32 &#x3D; 128</li>
</ol>
<p>  ë˜ ë‹¤ë¥¸ ë°©ë²•<br>  ê° ì±„ë„ì—ì„œ ë³„ë„ì˜ 2d convë¥¼ í•˜ëŠ” ë°©ë²•<br>  in_channels * channel_multipliter ì¤‘ê°„ì±„ë„ì€ ì—°ê²°ë˜ê³  1x1 convë¡œ out_channelsì— ë§¤í•‘</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Keras</span></span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> SeparableConv2D</span><br><span class="line">net = SeparableConv2D(<span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>))(net)</span><br><span class="line"><span class="comment"># ê·¸ëƒ¥ 2d</span></span><br></pre></td></tr></table></figure>

<p>  ì¶œì²˜ :<br>  <a target="_blank" rel="noopener" href="https://colab.research.google.com/drive/1i0Fwh-d8kF05o4QRfJG5dZt_P7G85MCS">source1</a><br>  <a target="_blank" rel="noopener" href="https://towardsdatascience.com/speeding-up-convolutional-neural-networks-240beac5e30f">source2</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-11-27T13:54:12.000Z" title="2020. 11. 27. ì˜¤í›„ 10:54:12">2020-11-27</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:52:26.227Z" title="2024. 12. 3. ì˜¤í›„ 2:52:26">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">8 minutes read (About 1216 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/27/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/">ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„6</a></p><div class="content"><h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-6"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-6" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-6"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-6</h2><h3 id="ğŸ’¥Remind-ë”¥ëŸ¬ë‹ì—-ë¹„ì„ í˜•-í™œì„±í™”-í•¨ìˆ˜ë¥¼-ì‚¬ìš©í•˜ëŠ”-ì´ìœ "><a href="#ğŸ’¥Remind-ë”¥ëŸ¬ë‹ì—-ë¹„ì„ í˜•-í™œì„±í™”-í•¨ìˆ˜ë¥¼-ì‚¬ìš©í•˜ëŠ”-ì´ìœ " class="headerlink" title="ğŸ’¥Remind!! ë”¥ëŸ¬ë‹ì— ë¹„ì„ í˜• í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ "></a>ğŸ’¥Remind!! ë”¥ëŸ¬ë‹ì— ë¹„ì„ í˜• í™œì„±í™” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </h3><p>  ì„ í˜• í•¨ìˆ˜ë¡œëŠ” XORê³¼ ê°™ì€ non-linearí•œ ë¬¸ì œëŠ” í•´ê²°ì´ ì•ˆë¨;;</p>
<blockquote>
<p>ê·¸ëŸ¬ë©´ Hidden Layerë¥¼ ëŠ˜ë¦¬ë©´ ë˜ì§€ ì•Šì„ê¹Œ?<br>  $f(ax+by) &#x3D; af(x) + bf(y)$ ë¼ëŠ” íŠ¹ì§• ë•Œë¬¸ì—<br>  N-layer ê¹Šì´ë¥¼ ì•„ë¬´ë¦¬ ìŒ“ì•„ë„ 1-Layerë¡œ ë™ì‘í•¨.</p>
</blockquote>
<h3 id="ìµœì í™”-Opt-ì•Œê³ ë¦¬ì¦˜"><a href="#ìµœì í™”-Opt-ì•Œê³ ë¦¬ì¦˜" class="headerlink" title="ìµœì í™”(Opt) ì•Œê³ ë¦¬ì¦˜"></a>ìµœì í™”(Opt) ì•Œê³ ë¦¬ì¦˜</h3><ul>
<li><p>ê²½ì‚¬í•˜ê°•ë²•(GD)<br>$$\theta &#x3D; \theta - \eta \nabla_\theta S(\theta)$$  </p>
<p>Networkì˜ parameter&#x3D;$ \theta $ ë¡œ í• ë•Œ ì†ì‹¤í•¨ìˆ˜ $ J(\theta) $ì˜ ê°’ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ ê¸°ìš¸ê¸°<br>$ \nabla J(\theta)$ë¥¼ ì´ìš©í•˜ëŠ” ë°©ë²•<br>GDì—ì„œëŠ” Gradientì˜ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì¼ì • í¬ê¸°(lr)ë§Œí¼ ì´ë™í•˜ëŠ” ê²ƒì„ ë°˜ë³µí•˜ì—¬ loss functionì˜ ê°’ì„ ìµœì†Œí™” í•˜ëŠ” $ \theta $ì˜ ê°’ì„ ì°¾ìŒ,  </p>
</li>
<li><p>lr(í•™ìŠµë¥ ) $ \eta $ ëŠ” ë³´í†µ 1e-3 ~ 1e-4 ì‚¬ì´ì—ì„œ ì‚¬ìš©í•¨.<br>  ë„ˆë¬´ í¬ë©´ global minimumì„ ì§€ë‚˜ì¹˜ê³  ë„ˆë¬´ ì‘ìœ¼ë©´ Local Minimumì— ë¹ ì§.</p>
</li>
<li><p>í™•ë¥ ì  ê²½ì‚¬í•˜ê°•ë²•(SGD)<br>ì „ì²´ Training setì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ batch Gradient Descent, ê³„ì‚°ëŸ‰ì´ ë§ì•„ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´<br>mini-batchì— ëŒ€í•´ì„œë§Œ ì†ì‹¤í•¨ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” í™•ë¥ ì  GDë¥¼ ì‚¬ìš©í•¨.<br>ê°™ì€ ì‹œê°„ì— ë” ë§ì€ stepë¥¼ ê°ˆ ìˆ˜ ìˆìŒ, ì—¬ëŸ¬ë²ˆ ë°˜ë³µí•  ê²½ìš° batchì˜ ê²°ê³¼ì™€ ë¹„ìŠ·í•¨</p>
</li>
<li><p>GD vs SGD<br>GD : í™•ì‹¤í•œë° ë„ˆë¬´ ëŠë¦¼ | SGD : ì¡°ê¸ˆ í—¤ë©”ì§€ë§Œ ë¹ ë¦„</p>
</li>
<li><p>Momentum : í˜„ì¬ Gradientë¥¼ í†µí•´ ì´ë™í•˜ëŠ” ë°©í–¥ê³¼ ë³„ê°œë¡œ ê³¼ê±°ì˜ ì´ë™ë°©ì‹ì„ ê¸°ì–µí•˜ë©´ì„œ ì¼ì¢…ì˜ ê´€ì„±ì„ ì£¼ëŠ” ë°©ì‹</p>
</li>
<li><p>AdaGrad(Adaptive Gradient)</p>
<ol>
<li>ë§ì´ ë³€í™”í–ˆë˜ ë³€ìˆ˜ë“¤ì€ step sizeë¥¼ ì‘ê²Œ í•˜ëŠ” ê²ƒ<br>ìì£¼ ë“±ì¥í•˜ê±°ë‚˜ ë³€í™”ë¥¼ ë§ì´ í•œ ë³€ìˆ˜ë“¤ì€ optimumì— ê°€ê¹Œì´ ìˆì„ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ì‘ì€ í¬ê¸°ë¡œ ì´ë™í•˜ë©´ì„œ ë¯¸ì„¸ì¡°ì ˆ</li>
<li>ì ê²Œ ë³€í™”í•œ ë³€ìˆ˜ë“¤ì€ ë§ì´ ì´ë™í•´ì•¼í•  í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ë¨¼ì € ë¹ ë¥´ê²Œ lossê°’ì„ ì¤„ì´ëŠ” ë°©ì‹ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë°©ì‹<br>í•™ìŠµì„ ê³„ì† ì§„í–‰í•˜ë©´ step sizeê°€ ë„ˆë¬´ ì¤„ì–´ë“œëŠ” ë‹¨ì ì´ ìˆìŒ.<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_05.PNG" alt="AdaGrad"></li>
</ol>
</li>
<li><p>RMSProp<br>í•©ì„ ì§€ìˆ˜í‰ê· ìœ¼ë¡œ ëŒ€ì²´í•˜ì—¬ Adagradì˜ ë‹¨ì ì„ í•´ê²°<br>Gê°€ ë¬´í•œì • ì»¤ì§€ì§€ëŠ” ì•Šìœ¼ë©´ì„œ ìµœê·¼ ë³€í™”ëŸ‰ì˜ ë³€ìˆ˜ê°„ ìƒëŒ€ì ì¸ í¬ê¸° ì°¨ì´ëŠ” ìœ ì§€í•  ìˆ˜ ìˆìŒ.<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_04.PNG" alt="RMsprop"></p>
</li>
<li><p>Adam<br>Momentum + RMSProp</p>
<ol>
<li>ì§€ê¸ˆê¹Œì§€ ê³„ì‚°í•´ì˜¨ ê¸°ìš¸ê¸°ì˜ ì§€ìˆ˜í‰ê· ì„ ì €ì¥</li>
<li>rmspropê³¼ ìœ ì‚¬í•˜ê²Œ Gradientì˜ ì œê³±ê°’ì˜ ì§€ìˆ˜í‰ê· ì„ ì €ì¥<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_06.PNG" alt="Adam"></li>
</ol>
</li>
</ul>
<h3 id="Overfitting-ê³¼ì í•©"><a href="#Overfitting-ê³¼ì í•©" class="headerlink" title="Overfitting(ê³¼ì í•©)"></a>Overfitting(ê³¼ì í•©)</h3><p>  Training Setì˜ ì§€ì—½ì ì¸ íŠ¹ì„±ê¹Œì§€ ë°˜ì˜í•´ Variance Highë¡œ Trainingë˜ì–´ì„œ Training Setì„ ì•”ê¸°í•´ë²„ë¦¬ëŠ” í˜„ìƒ<br>  <em>Test Setì„ ì˜ ì˜ˆì¸¡í•˜ì§€ ëª»í•¨</em><br>  ì£¼ë¡œ í‘œí˜„ë ¥ì´ ë†’ì€ ëª¨ë¸, ì¦‰ íŒŒë¼ë¯¸í„°ê°€ ë§ì€ ëª¨ë¸ì— ë°œìƒ</p>
<ol>
<li>ì •ê·œí™”(Regularization)</li>
</ol>
<ul>
<li>ì†ì‹¤í•¨ìˆ˜ì— ê°€ì¤‘ì¹˜ì˜ í¬ê¸°ë¥¼ í¬í•¨</li>
<li>ê°€ì¤‘ì¹˜ê°€ ì‘ì•„ì§€ë„ë¡ í•™ìŠµí•œë‹¤ëŠ” ê²ƒì€ Outlier(Noise)ì˜ ì˜í–¥ì„ ì ê²Œ ë°›ìŒ</li>
</ul>
<h4 id="L2-ì •ê·œí™”"><a href="#L2-ì •ê·œí™”" class="headerlink" title="L2 ì •ê·œí™”"></a>L2 ì •ê·œí™”</h4><p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_08.PNG" alt="L2"></p>
<p><em>Rigde Regression</em></p>
<h4 id="L1-ì •ê·œí™”"><a href="#L1-ì •ê·œí™”" class="headerlink" title="L1 ì •ê·œí™”"></a>L1 ì •ê·œí™”</h4><p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_09.PNG" alt="L1"><br>Sparse Modelì— ì•Œë§ìŒ.. ì‘ì€ ê°€ì¤‘ì¹˜ë“¤ì´ ê±°ì˜ 0ìœ¼ë¡œ ìˆ˜ë ´í•˜ì—¬ ëª‡ê°œì˜ ì¤‘ìš”í•œ ê°€ì¤‘ì¹˜ë“¤ë§Œ ë‚¨ìŒ. </p>
<p><em>Lasso Regression</em></p>
<p>ë¯¸ë¶„ ë¶ˆê°€ëŠ¥í•œ ì ì´ ìˆê¸° ë•Œë¬¸ì— Gradient-Base Learningì—ëŠ” ì£¼ì˜..<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_10.PNG" alt="L1ì£¼ì˜ì "></p>
<h4 id="DropOut"><a href="#DropOut" class="headerlink" title="DropOut"></a>DropOut</h4><p>ê° ë ˆì´ì–´ì˜ ì¼ì • ë¹„ìœ¨ë¡œ ë‰´ëŸ°ì˜ ì¶œë ¥ ê°’ì„ 0ìœ¼ë¡œ ë§Œë“¤ì–´ ë‚˜ë¨¸ì§€ ë‰´ëŸ°ë“¤ë¡œ í•™ìŠµí•˜ëŠ” ë°©ë²•<br>ê³¼ì í•©ì„ íš¨ê³¼ì ìœ¼ë¡œ ì˜ˆë°© ê°€ëŠ¥(Network ë‚´ë¶€ì˜ Ensemble í•™ìŠµìœ¼ë¡œ ë³¼ ìˆ˜ ìˆìŒ)</p>
<p>ì—­ì „íŒŒëŠ” ReLUì²˜ëŸ¼ ë™ì‘<br>Forward Propagationë•Œ ì‹œê·¸ë„ì„ í†µê³¼ì‹œí‚¨ ë‰´ëŸ°ì€ Backwardë•Œë„ í†µê³¼ì‹œí‚´<br>dropëœ ë‰´ëŸ°ì€ Backward Propagationë•Œë„ ì‹œê·¸ë„ ì°¨ë‹¨</p>
<p>ë°˜ë©´, TESTë•ŒëŠ” ëª¨ë“  ë‰´ëŸ°ì— ì‹ í˜¸ë¥¼ ì „ë‹¬í•¨</p>
<h4 id="Batch-Normalization"><a href="#Batch-Normalization" class="headerlink" title="Batch Normalization"></a>Batch Normalization</h4><p>í•™ìŠµí•˜ëŠ” ì´ì „ ì¸µì˜ íŒŒë¼ë¯¸í„° ë³€í™”ë¡œ í˜„ì¬ì¸µì˜ ì…ë ¥ ë¶„í¬ê°€ ë°”ë€ŒëŠ” í˜„ìƒì„ ë‚´ë¶€ ê³µë¶„ì‚° ë³€í™”(Internal Covariate Shift)<br>ì´ì „ ì¸µì˜ ì‘ì€ íŒŒë¼ë¯¸í„° ë³€í™”ê°€ ì¦í­ë˜ì–´ ë’· ë ˆì´ì–´ì— í° ì˜í–¥ì„ ë°›ìŒ.<br>ê·¸ë˜ì„œâ€¦</p>
<p>BN(2015)</p>
<ul>
<li>Gradient Vanishing, Explodingì„ ë°©ì§€í•˜ëŠ” ëŒ€í‘œì ì¸ ë°©ë²•</li>
<li>ì§ì ‘ì ì¸ ë°©ë²•ì„.</li>
<li>Training ê³¼ì • ìì²´ë¥¼ ì•ˆì •í™”ì‹œì¼œ í•™ìŠµì†ë„ë¥¼ ê°€ì†í™”</li>
<li>í‰ê· ê³¼ ë¶„ì‚°ì„ ì¡°ì ˆí•˜ëŠ” ê³¼ì •ì´ <em>NN ì•ˆì— í¬í•¨</em> ë˜ì–´ ìˆë‹¤ëŠ” ê²ƒì´ í•µì‹¬ì </li>
</ul>
<p>Trainingí• ë•Œ<br>ê° Mini Batchë§ˆë‹¤ $ \gamma $ ì™€ $ \beta $ë¥¼ êµ¬í•˜ê³  ì €ì¥í•´ ë‘ </p>
<p>Testí• ë•Œ<br>êµ¬í–ˆë˜ $ \gamma $  ì™€ $ \beta $ ì˜ í‰ê· ì„ ì‚¬ìš©</p>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%846/ckpt_11.PNG" alt="BN"></p>
<h4 id="Data-Augmentation"><a href="#Data-Augmentation" class="headerlink" title="Data Augmentation"></a>Data Augmentation</h4><p>ì¼ì¢…ì˜ Regularizationì‘ì—…, ë°ì´í„°ê°€ ì ì„ ë•Œ ì‚¬ìš©í•˜ë©´ ë§¤ìš° íš¨ê³¼ì <br>ì¦‰ ë°ì´í„° ë³€í˜•</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-11-25T12:49:48.000Z" title="2020. 11. 25. ì˜¤í›„ 9:49:48">2020-11-25</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:52:45.194Z" title="2024. 12. 3. ì˜¤í›„ 2:52:45">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">5 minutes read (About 800 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/25/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/">ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„5</a></p><div class="content"><h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-5"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-5" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-5"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-5</h2><h3 id="ì„ í˜•ëŒ€ìˆ˜-ë°°ì›Œë³´ê¸°-í–‰ë ¬ì„-ì•„ë¬´ë¦¬-ê³±í•˜ê³ -ë”í•´ë„-ì„ ëª¨ì–‘"><a href="#ì„ í˜•ëŒ€ìˆ˜-ë°°ì›Œë³´ê¸°-í–‰ë ¬ì„-ì•„ë¬´ë¦¬-ê³±í•˜ê³ -ë”í•´ë„-ì„ ëª¨ì–‘" class="headerlink" title="ì„ í˜•ëŒ€ìˆ˜ ë°°ì›Œë³´ê¸°(í–‰ë ¬ì„ ì•„ë¬´ë¦¬ ê³±í•˜ê³  ë”í•´ë„ ì„ ëª¨ì–‘)"></a>ì„ í˜•ëŒ€ìˆ˜ ë°°ì›Œë³´ê¸°(í–‰ë ¬ì„ ì•„ë¬´ë¦¬ ê³±í•˜ê³  ë”í•´ë„ ì„ ëª¨ì–‘)</h3><h4 id="Scala-í¬ê¸°ë§Œ-ì¡´ì¬í•˜ëŠ”-ì–‘"><a href="#Scala-í¬ê¸°ë§Œ-ì¡´ì¬í•˜ëŠ”-ì–‘" class="headerlink" title="Scala : í¬ê¸°ë§Œ ì¡´ì¬í•˜ëŠ” ì–‘"></a>Scala : í¬ê¸°ë§Œ ì¡´ì¬í•˜ëŠ” ì–‘</h4><h4 id="Vector-ì†ë„-ìœ„ì¹˜ì´ë™-í˜-ê³µê°„ë’¤í‹€ë¦¼ê³¼-ê°™ì´-í¬ê¸°ì™€-ë°©í–¥ì´-ëª¨ë‘-ì¡´ì¬í•˜ëŠ”-ì–‘"><a href="#Vector-ì†ë„-ìœ„ì¹˜ì´ë™-í˜-ê³µê°„ë’¤í‹€ë¦¼ê³¼-ê°™ì´-í¬ê¸°ì™€-ë°©í–¥ì´-ëª¨ë‘-ì¡´ì¬í•˜ëŠ”-ì–‘" class="headerlink" title="Vector : ì†ë„, ìœ„ì¹˜ì´ë™, í˜, ê³µê°„ë’¤í‹€ë¦¼ê³¼ ê°™ì´ í¬ê¸°ì™€ ë°©í–¥ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ì–‘"></a>Vector : ì†ë„, ìœ„ì¹˜ì´ë™, í˜, ê³µê°„ë’¤í‹€ë¦¼ê³¼ ê°™ì´ í¬ê¸°ì™€ ë°©í–¥ì´ ëª¨ë‘ ì¡´ì¬í•˜ëŠ” ì–‘</h4><p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/slido51_1.PNG" alt="ìŠ¤ì¹¼ë¼ì™€ë²¡í„°"></p>
<h4 id="Norm-nì°¨ì›-ë²¡í„°-vec-x-x-1-x-2-cdots-x-n"><a href="#Norm-nì°¨ì›-ë²¡í„°-vec-x-x-1-x-2-cdots-x-n" class="headerlink" title="Norm ? nì°¨ì› ë²¡í„° $$\vec{x} &#x3D; (x_1, x_2, \cdots x_n)$$"></a>Norm ? nì°¨ì› ë²¡í„° $$\vec{x} &#x3D; (x_1, x_2, \cdots x_n)$$</h4><p>Norm $$\lVert x \rVert &#x3D; \sqrt{x_1^1 + x_2^2 + \cdots + x_n^2}$$</p>
<blockquote>
<p>â€œì›ì  Oì—ì„œ ì \(x_1, x_2, \cdots, x_n\) ê¹Œì§€ì˜ ê±°ë¦¬â€</p>
</blockquote>
<h4 id="ë‚´ì -Inner-product-Dot-product"><a href="#ë‚´ì -Inner-product-Dot-product" class="headerlink" title="ë‚´ì  ?  Inner product, Dot product"></a>ë‚´ì  ?  Inner product, Dot product</h4><h4 id="í–‰ë ¬ë¼ë¦¬-ê³±í• -ë•ŒëŠ”-ì°¨ì›ì„-ì£¼ì˜í•œë‹¤"><a href="#í–‰ë ¬ë¼ë¦¬-ê³±í• -ë•ŒëŠ”-ì°¨ì›ì„-ì£¼ì˜í•œë‹¤" class="headerlink" title="í–‰ë ¬ë¼ë¦¬ ê³±í•  ë•ŒëŠ” ì°¨ì›ì„ ì£¼ì˜í•œë‹¤."></a>í–‰ë ¬ë¼ë¦¬ ê³±í•  ë•ŒëŠ” ì°¨ì›ì„ ì£¼ì˜í•œë‹¤.</h4><blockquote>
<p>A(m, n) * B(n, m) ë§Œ ê°€ëŠ¥</p>
</blockquote>
<h4 id="Transpose-ì „ì¹˜í–‰ë ¬-í–‰ê³¼-ì—´ì„-ë’¤ë°”ê¿ˆ"><a href="#Transpose-ì „ì¹˜í–‰ë ¬-í–‰ê³¼-ì—´ì„-ë’¤ë°”ê¿ˆ" class="headerlink" title="Transpose: ì „ì¹˜í–‰ë ¬(í–‰ê³¼ ì—´ì„ ë’¤ë°”ê¿ˆ)"></a>Transpose: ì „ì¹˜í–‰ë ¬(í–‰ê³¼ ì—´ì„ ë’¤ë°”ê¿ˆ)</h4><blockquote>
<p>A.T</p>
</blockquote>
<h3 id="numpy-ì—°ì‚°-Element-wise-operation"><a href="#numpy-ì—°ì‚°-Element-wise-operation" class="headerlink" title="numpy ì—°ì‚°(Element-wise operation)"></a>numpy ì—°ì‚°(Element-wise operation)</h3><blockquote>
<p>np.dot(x, y) (aka ë‚´ì , dot-product)ì™€  x * y(element-wise)ëŠ” ì„œë¡œ ë‹¤ë¦„.</p>
</blockquote>
<h3 id="numpy-ë¹„êµ-ë…¼ë¦¬ì—°ì‚°-element-wise-operation"><a href="#numpy-ë¹„êµ-ë…¼ë¦¬ì—°ì‚°-element-wise-operation" class="headerlink" title="numpy ë¹„êµ, ë…¼ë¦¬ì—°ì‚°(element-wise operation)"></a>numpy ë¹„êµ, ë…¼ë¦¬ì—°ì‚°(element-wise operation)</h3><h3 id="numpy-Reductions"><a href="#numpy-Reductions" class="headerlink" title="numpy Reductions"></a>numpy Reductions</h3><blockquote>
<p>argmax() : ìµœëŒ€ê°’ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ë¦¬í„´, argmin() : ìµœì†Œê°’ì˜ ì¸ë±ìŠ¤ ë¦¬í„´</p>
</blockquote>
<h3 id="np-all-np-any"><a href="#np-all-np-any" class="headerlink" title="np.all, np.any?"></a>np.all, np.any?</h3><blockquote>
<p>ALL : Arrayë‚´ ëª¨ë“  ê°’ì´ TRUEì¸ê°€?<br>  any : Arrayë‚´ ê°’ì´ í•˜ë‚˜ë¼ë„ TRUEì¸ê°€?</p>
</blockquote>
<h3 id="np-mean-np-median-np-std-ë“±-í†µê³„í•¨ìˆ˜-ì‚¬ìš©-ê°€ëŠ¥"><a href="#np-mean-np-median-np-std-ë“±-í†µê³„í•¨ìˆ˜-ì‚¬ìš©-ê°€ëŠ¥" class="headerlink" title="np.mean, np.median, np.std ë“± í†µê³„í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥"></a>np.mean, np.median, np.std ë“± í†µê³„í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥</h3><h4 id="ë”¥ëŸ¬ë‹ì—-ëŒ€í•œ-í™˜ìƒ"><a href="#ë”¥ëŸ¬ë‹ì—-ëŒ€í•œ-í™˜ìƒ" class="headerlink" title="ë”¥ëŸ¬ë‹ì— ëŒ€í•œ í™˜ìƒ"></a>ë”¥ëŸ¬ë‹ì— ëŒ€í•œ í™˜ìƒ</h4><ol>
<li><p>ë³µì¡í•œ ë¬¸ì œë„ ì¸µì„ ê¹Šê³  ë„“ê²Œ ìŒ“ìœ¼ë©´ í•´ê²°ëœë‹¤ â€“&gt; Gradient Vanhshing, Initialize fault ìœ¼í•˜í•˜í•°ã…‹ã…‹ã…‹</p>
</li>
<li><p>$$Sigmoid(z) &#x3D; \frac{1} {1 + e^{-z}}$$<br>  Sigmoid ë„í•¨ìˆ˜ì˜ ìµœëŒ€ê°’ì€ 1&#x2F;4 â€¦ â€“&gt; ê·¸ë˜ì„œ Gradient Vanishing ë‚˜ëŠ”ê±°ì„ ã…‡ã…‡</p>
</li>
</ol>
<h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”</h4><ol>
<li><p>ì´ˆê¸°í™”ì˜ ì¤‘ìš”ì„±<br>  $ y &#x3D; Wx+b $ ì—ì„œ<br>   wê°€ 100, bê°€ 50ì´ë¼ë©´ xê°€ 0.01ì´ë”ë¼ë„ yëŠ” 51ì´ ë¨<br>  ì—­ì „íŒŒë•Œ sigmoid í•¨ìˆ˜ í†µê³¼ì‹œí‚¤ë©´ $ Sigmoidâ€™(51) $ ë¦¬í„´ë¨<br>  í•˜ì§€ë§Œ yê°€ 5ë§Œ ë„˜ì–´ë„ $ Sigmoid (y) $ ëŠ” 0ì— ìˆ˜ë ´<br>  â€“&gt; ì´ê²ƒì´ ë°”ë¡œ Gradient Vanishingâ€¦</p>
</li>
<li><p>ê·¸ë˜ì„œ ì…ë ¥ì¸µì˜ ê°€ì¤‘ì¹˜wë¥¼ ëª¨ë‘ 0ìœ¼ë¡œ ë¦¬ì…‹!<br>  Forward Propagationë•Œ ë‘ë²ˆì§¸ ì¸µ ë‰´ëŸ°ì— ëª¨ë‘ ê°™ì€ ê°’ì´ ì „ë‹¬ë¨<br>  Backward Propagationë•Œ ë‘ì§¸ ì¸µ ê°€ì¤‘ì¹˜ê°€ ëª¨ë‘ ë˜‘ê°™ì´ ì—…ë°ì´íŠ¸ &#x3D;&#x3D;&gt; ì‹ ê²½ë§ í‘œí˜„ë ¥ ì œí•œ</p>
</li>
<li><p>BiasëŠ” 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ëŠ”ê²Œ ì¼ë°˜ì ìœ¼ë¡œ íš¨ìœ¨ì </p>
</li>
</ol>
<h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-2"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-2" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 2"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 2</h4><ol>
<li><p>í‘œì¤€ ì •ê·œë¶„í¬ë¥¼ ì´ìš©í•œ ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”<br>  Sigmoidí•¨ìˆ˜ì˜ ì¶œë ¥ê°’ì´ ê·¹ë‹¨ì ìœ¼ë¡œ(0 or 1)ì— ì¹˜ìš°ì¹˜ëŠ” í˜„ìƒ â€“&gt; Gradient Vanishing</p>
</li>
<li><p>í‘œì¤€í¸ì°¨ë¥¼ 0.01ë¡œ í•˜ëŠ” ì •ê·œë¶„í¬ë¡œ ì´ˆê¸°í™”<br>  ê°€ì¤‘ì¹˜ê°€ ëª¨ì—¬ ìˆìŒ &#x3D;&gt; ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œ ì–´ëŠì •ë„ ì™„í™”ë¨</p>
</li>
</ol>
<h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-3"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-3" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 3"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 3</h4><p>  Xavierì´ˆê¸°í™” ë°©ë²•(2010)<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w = np.random.randn(n_input, n_output) / (n_input) ** <span class="number">0.5</span></span><br></pre></td></tr></table></figure><br>  Sigmoidì™€ ê°™ì€ Sì í•¨ìˆ˜ì˜ ê²½ìš° ì¶œë ¥ê°’ë“¤ì´ ì •ê·œë¶„í¬ í˜•íƒœì´ì–´ì•¼ ì•ˆì •ì  í•™ìŠµ ê°€ëŠ¥  </p>
<ul>
<li><p>Sigmoid functionê³¼ Xavier Initë°©ë²•ì„ ì‚¬ìš©í–ˆì„ ê²½ìš° ê·¸ë˜í”„<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_01.PNG" alt="sigmodi"></p>
</li>
<li><p>ReLU ê³„ì—´ í•¨ìˆ˜ì—ëŠ” ì ì ˆí•˜ì§€ ì•ŠìŒ<br>layerë¥¼ ê±°ì³ê°ˆ ìˆ˜ë¡ 0ì— ìˆ˜ë ´(converge)</p>
<p><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_02.PNG" alt="reluNo"></p>
</li>
</ul>
<h4 id="ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-4"><a href="#ê°€ì¤‘ì¹˜-ì´ˆê¸°í™”-4" class="headerlink" title="ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 4"></a>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™” 4</h4><p>  He ì´ˆê¸°í™” ë°©ë²•(2015)<br>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w = np.random.randn(n_input, n_output) / (n_input / <span class="number">2</span>) ** <span class="number">0.5</span></span><br></pre></td></tr></table></figure></p>
<p>  RELU + He init â€“&gt; 10 layerë¥¼ ê±°ì³ë„ í‘œì¤€í¸ì°¨ê°€ 0ìœ¼ë¡œ ìˆ˜ë ´í•˜ì§€ ì•ŠìŒ<br>  <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%845/ckpt_03.PNG" alt="relu"></p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><ul>
<li>ê°€ì¤‘ì¹˜ ì´ˆê¸°í™”ëŠ” ë„ˆë¬´ë‚˜ ì¤‘ìš”í•¨</li>
<li>tanhì˜ ê²½ìš° Xavier Init ë°©ë²•ì´ íš¨ìœ¨ì </li>
<li>ReLUê³„ì—´ í•¨ìˆ˜ì—ëŠ” He Init ë°©ë²•ì´ íš¨ìœ¨ì </li>
<li>ìµœê·¼ì—” ëŒ€ë¶€ë¶„ He Initë¥¼ ì£¼ë¡œ ì‚¬ìš©</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-11-24T13:24:21.000Z" title="2020. 11. 24. ì˜¤í›„ 10:24:21">2020-11-24</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-12-03T05:55:57.149Z" title="2024. 12. 3. ì˜¤í›„ 2:55:57">2024-12-03</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">4 minutes read (About 601 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/24/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/">ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„4</a></p><div class="content"><h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-4"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-4" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-4"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-4</h2><h3 id="ì¸ê³µì‹ ê²½ë§ê³¼-ì†ì‹¤í•¨ìˆ˜"><a href="#ì¸ê³µì‹ ê²½ë§ê³¼-ì†ì‹¤í•¨ìˆ˜" class="headerlink" title="ì¸ê³µì‹ ê²½ë§ê³¼ ì†ì‹¤í•¨ìˆ˜"></a>ì¸ê³µì‹ ê²½ë§ê³¼ ì†ì‹¤í•¨ìˆ˜</h3><ol>
<li>ì¸ê³µì‹ ê²½ë§ì˜ ê¸°ë³¸ êµ¬ì¡°</li>
</ol>
<ul>
<li>ë‡Œì˜ í•™ìŠµë°©ë²•ì„ ìˆ˜í•™ì ìœ¼ë¡œ ëª¨ë¸ë§í•œ ê¸°ê³„í•™ìŠµ ì•Œê³ ë¦¬ì¦˜</li>
<li>ê¸°ë³¸ êµ¬ì¡° : y &#x3D; Wx+b<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_1.PNG" alt="ì¸ê³µì‹ ê²½ë§"><br> $ x_i $ : ì…ë ¥, $ w_i $: ê°€ì¤‘ì¹˜, b : bias, f: í™œì„±í™”í•¨ìˆ˜<br> u : ê²°í•©(Net), z: ì¶œë ¥</li>
<li>ë‰´ëŸ°ì—ëŠ” ì„ í˜• ê²°í•©ê³¼ í™œì„±í™” í•¨ìˆ˜ ê¸°ëŠ¥ì´ ë“¤ì–´ìˆìŒ</li>
<li>ì…ë ¥ì¸µ, ì€ë‹‰ì¸µ, ì¶œë ¥ì¸µìœ¼ë¡œ êµ¬ì„±ë¨</li>
<li>ê° ë…¸ë“œì˜ ë‰´ëŸ° ì¶œë ¥ì€ ì§ì ‘ ì „ë‹¬ë˜ëŠ” ì •ë³´ì—ë§Œ ì˜ì¡´í•  ë¿ ë‹¤ë¥¸ ë…¸ë“œì™€ëŠ” ë¬´ê´€</li>
<li>ê·¸ë˜ì„œ? ë³‘ë ¬ì²˜ë¦¬ê°€ ê°€ëŠ¥í•¨.</li>
</ul>
<ol start="2">
<li>ì†ì‹¤ í•¨ìˆ˜(Loss or Cost function)</li>
</ol>
<ul>
<li>ì‹ ê²½ë§ì˜ ì¶œë ¥ê°’ê³¼ ì‹¤ì œ ê²°ê³¼ê°’ì˜ ì°¨ì´ë¥¼ ì •ì˜í•˜ëŠ” í•¨ìˆ˜</li>
<li>ì‹ ê²½ë§ í•™ìŠµëª©í‘œëŠ” ì†ì‹¤í•¨ìˆ˜ë¥¼ ìµœì†Œí™” í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì›€ì§ì—¬ì•¼ í•¨</li>
<li>SGD, Adam ë“±ì˜ í•™ìŠµ ìµœì í™” ì•Œê³ ë¦¬ì¦˜</li>
</ul>
<ol start="3">
<li>ì†ì‹¤ í•¨ìˆ˜</li>
</ol>
<ul>
<li><p>íšŒê·€(Regression)<br> ì œê³± ì˜¤ì°¨(MSE) ì‚¬ìš©, ìµœê·¼ì—ëŠ” rmse, maeì˜ ì¥ì ì´ ìˆëŠ” Huber Loss ì‚¬ìš©í•˜ëŠ” ì¶”ì„¸<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_4.PNG" alt="íšŒê·€"></p>
</li>
<li><p>Huber Loss?<br>MAE + MSE -&gt; for Time Series Data!!<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_5.PNG" alt="huber"><br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_7.PNG" alt="huber Loss"></p>
</li>
<li><p>ë¶„ë¥˜(Classification)<br> í™œì„±í™” í•¨ìˆ˜ : softmax, ì†ì‹¤í•¨ìˆ˜ : cross-entropy<br><img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_2.PNG" alt="ë¶„ë¥˜"></p>
</li>
</ul>
<h3 id="ì•Œê³ ë¦¬ì¦˜ê³¼-ì—­ì „íŒŒ"><a href="#ì•Œê³ ë¦¬ì¦˜ê³¼-ì—­ì „íŒŒ" class="headerlink" title="ì•Œê³ ë¦¬ì¦˜ê³¼ ì—­ì „íŒŒ"></a>ì•Œê³ ë¦¬ì¦˜ê³¼ ì—­ì „íŒŒ</h3><ol>
<li>í•™ìŠµ ì•Œê³ ë¦¬ì¦˜</li>
</ol>
<ul>
<li>ê²½ì‚¬ í•˜ê°•ë²•: ê¸°ìš¸ê¸°ë¥¼ ì´ìš©í•˜ì—¬ ì†ì‹¤í•¨ìˆ˜ S($ \theta $) ê°’ì„ ìµœì í™”</li>
<li>gradient(ê¸°ìš¸ê¸°)ì˜ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì¼ì • í¬ê¸°ë§Œí¼ ì´ë™í•˜ëŠ” ê²ƒì„ ë°˜ë³µí•˜ì—¬<br> ì†ì‹¤í•¨ìˆ˜ì˜ ê°’ì„ ìµœì†Œí™”í•˜ëŠ” $ \theta $ì˜ ê°’ì„ ì°¾ìŒ</li>
<li>\[\theta &#x3D; \theta - \eta \nabla_\theta S(\theta)\]</li>
<li>ì´ ë–„ $ eta $ ëŠ” ë¯¸ë¦¬ ì •í•´ì§„ learning rate(step size) ì´ê³  ë³´í†µ 1e-3 ~ 1e-4 ì •ë„ë¥¼ ì‚¬ìš©</li>
</ul>
<ol start="2">
<li>ì—­ì „íŒŒ</li>
</ol>
<ul>
<li><p>ê³„ì‚° ê·¸ë˜í”„</p>
</li>
<li><p>ë…¸ë“œëŠ” ì—°ì‚°ì„, ì—£ì§€ëŠ” ë°ì´í„°ì˜ íë¦„ë°©í–¥<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_8.PNG" alt="Chain Rule"></p>
</li>
<li><p>sigmoid í•¨ìˆ˜ ì—­ì „íŒŒ<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_9.PNG" alt="sigmoidBP"></p>
</li>
<li><p>í•©ì„±í•¨ìˆ˜ ë¯¸ë¶„ë²•(Chain Rule)<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_10.PNG" alt="í•©ì„±ë¯¸ë¶„"></p>
</li>
<li><p>í–‰ë ¬ì—°ì‚°ê³¼ ì—­ì „íŒŒ 1<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_11.PNG" alt="í–‰ë ¬ì—­ì „íŒŒ"></p>
</li>
<li><p>ì´ì§„ë¶„ë¥˜ 2-layer NN ì—­ì „íŒŒ<br> <img src="/img/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%844/Letitgo_12.PNG" alt="ì´ì§„ì—­ì „íŒŒ"></p>
</li>
</ul>
<blockquote>
<p>to be continuedâ€¦</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-11-22T19:44:55.000Z" title="2020. 11. 23. ì˜¤ì „ 4:44:55">2020-11-23</time></span><span class="level-item">Updated&nbsp;<time dateTime="2022-04-05T06:19:36.732Z" title="2022. 4. 5. ì˜¤í›„ 3:19:36">2022-04-05</time></span><span class="level-item"><a class="link-muted" href="/categories/Study/">Study</a></span><span class="level-item">a few seconds read (About 111 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/11/23/%EB%94%A5%EB%9F%AC%EB%8B%9D-%EC%9E%85%EB%AC%B8%EA%B3%BC-%EC%A4%80%EB%B9%843/">ë”¥ëŸ¬ë‹-ì…ë¬¸ê³¼-ì¤€ë¹„3</a></p><div class="content"><h2 id="ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-3"><a href="#ë”¥ëŸ¬ë‹-ì‹œì‘í•´ë³´ê¸°-3" class="headerlink" title="ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-3"></a>ë”¥ëŸ¬ë‹ ì‹œì‘í•´ë³´ê¸°-3</h2><h3 id="ì°¨ì›ìˆ˜-ëŠ˜ë¦¬ê¸°-ì¤„ì´ê¸°-TF2-x"><a href="#ì°¨ì›ìˆ˜-ëŠ˜ë¦¬ê¸°-ì¤„ì´ê¸°-TF2-x" class="headerlink" title="ì°¨ì›ìˆ˜ ëŠ˜ë¦¬ê¸°, ì¤„ì´ê¸°(TF2.x)"></a>ì°¨ì›ìˆ˜ ëŠ˜ë¦¬ê¸°, ì¤„ì´ê¸°(TF2.x)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x = tf.expand_dims(x, <span class="number">1</span>)</span><br><span class="line">x.shape <span class="comment"># (x.shape, 1)</span></span><br><span class="line"></span><br><span class="line">x[..., tf.newaxis].shape <span class="comment"># (x.shape, 1)</span></span><br><span class="line"></span><br><span class="line">np.squeeze(x[<span class="number">0</span>]).shape <span class="comment"># x.shape ì°¨ì› ì¤„ì´ê¸°</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="TF2-x-Layers"><a href="#TF2-x-Layers" class="headerlink" title="TF2.x Layers"></a>TF2.x Layers</h3><p>Convolution</p>
<ul>
<li>filters : layerì—ì„œ ì¶œë ¥ë ë•Œ ëª‡ê°œì˜ filter</li>
<li>kernel_size : filter(weight) ì˜ ì‚¬ì´ì¦ˆ</li>
<li>strides : ëª‡ ê°œì˜ pixelë§Œí¼ skipí•˜ë©´ì„œ sliding window í•  ê²ƒì¸ì§€</li>
<li>padding : same, zero</li>
<li>activation : í™œì„±í™” í•¨ìˆ˜(<em>Linear functionì€ ì¸µì„ ìŒ“ëŠ” ì˜ë¯¸ê°€ ì—†ë‹¤</em>)</li>
</ul>
<blockquote>
<p>to be Continuedâ€¦</p>
</blockquote>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/">Previous</a></div><div class="pagination-next"><a href="/page/3/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link is-current" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="MELoDy-sigmax"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">MELoDy-sigmax</p><p class="is-size-6 is-block">Musical Data blog</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Seoul</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives/"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories/"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags/"><p class="title">12</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://sinandar-xronier.github.io/" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://sinandar-xronier.github.io/"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Competition/"><span class="level-start"><span class="level-item">Competition</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Study/"><span class="level-start"><span class="level-item">Study</span></span><span class="level-end"><span class="level-item tag">18</span></span></a><ul><li><a class="level is-mobile" href="/categories/Study/Dacon/"><span class="level-start"><span class="level-item">Dacon</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Study/Game/"><span class="level-start"><span class="level-item">Game</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Study/Kaggle-Dacon/"><span class="level-start"><span class="level-item">Kaggle, Dacon</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-10-06T01:36:26.000Z">2023-10-06</time></p><p class="title"><a href="/2023/10/06/music2motion-project/">music2motion_project</a></p><p class="categories"><a href="/categories/Study/">Study</a> / <a href="/categories/Study/Game/">Game</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-15T23:28:46.000Z">2023-03-16</time></p><p class="title"><a href="/2023/03/16/%EA%B2%8C%EC%9E%84%EA%B0%9C%EB%B0%9C-%EC%9D%BC%EA%B8%B02/">ê²Œì„ê°œë°œ-ì¼ê¸°2</a></p><p class="categories"><a href="/categories/Game/">Game</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-16T09:23:41.000Z">2022-10-16</time></p><p class="title"><a href="/2022/10/16/rl-video-summ/">rl-video-summ</a></p><p class="categories"><a href="/categories/Study/">Study</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-05T07:26:50.000Z">2022-04-05</time></p><p class="title"><a href="/2022/04/05/hello-world/">Hello World</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-04-05T07:26:50.000Z">2022-04-05</time></p><p class="title"><a href="/2022/04/05/bbackcheem/">bbackcheem</a></p></div></article></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/10/"><span class="level-start"><span class="level-item">October 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/03/"><span class="level-start"><span class="level-item">March 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">October 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/09/"><span class="level-start"><span class="level-item">September 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Audio/"><span class="tag">Audio</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DL/"><span class="tag">DL</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dacon/"><span class="tag">Dacon</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GAN/"><span class="tag">GAN</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linear-Algebra/"><span class="tag">Linear Algebra</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ML/"><span class="tag">ML</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Try/"><span class="tag">Try</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unity/"><span class="tag">Unity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/XR/"><span class="tag">XR</span><span class="tag">2</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Xeoner&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2024 Xeoner</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© 2024</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>